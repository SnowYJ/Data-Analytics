<!DOCTYPE html>

<html class="theme">

<head>
    <meta charset="utf-8">
    
    <meta name="description" content="Cmd Markdown 编辑阅读器，支持实时同步预览，区分写作和阅读模式，支持在线存储，分享文稿网址。">
    <meta name="author" content="Jiawei Zhang">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <title>零基础入门深度学习(7) - 递归神经网络 - 作业部落 Cmd Markdown 编辑阅读器</title>


    <link href="https://zybuluo.com/static/img/favicon.png" type="image/x-icon" rel="icon">

    <link href="https://zybuluo.com/static/assets/1bc053c8.base.lib.min.css" rel="stylesheet" media="screen">


    
    <!-- id="prettify-style" will be used to get the link element below and change href to change prettify code, so it can't be in beginmin/endmin block. -->
    <link id="prettify-style" href="https://zybuluo.com/static/editor/libs/google-code-prettify/prettify-cmd.css" type="text/css" rel="stylesheet">
    <!--
    <link id="mermaid-style" href="https://zybuluo.com/static/editor/libs/mermaid/mermaid.forest.css" type="text/css" rel="stylesheet">
    -->
    <link href="https://zybuluo.com/static/assets/mdeditor/45c7d56d.layout.min.css" rel="stylesheet" media="screen">


    

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-44461741-1', 'zybuluo.com');
      ga('send', 'pageview');
    </script>
</head>

<body class="theme">

    <div id="global-prompt-alert" class="hide alert alert-warning">
        <span id="global-prompt-message"></span>
        <a id="close-global-prompt-alert" href="">[关闭]</a>
    </div>

    <!-- zybuluo's body -->
    







<!-- mdeditor's body -->






<div id="editor-reader-full" class="editor-reader-full-shown" style="position: static;">
    <div id="reader-full-topInfo" class="reader-full-topInfo-shown">
        <span>
            <code>@hanbingtao</code>
        </span>
        <code><span class="article-updated-date">2017-08-29T15:41:15.000000Z</span></code>
        <code><span>字数 </span><span class="article-characters">14413</span></code>
        <code><span>阅读 </span><span class="article-read">94676</span></code>
    </div>
    <div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="ti22" id="零基础入门深度学习7-递归神经网络">零基础入门深度学习(7) - 递归神经网络</h1><p data-anchor-id="y9eo"><code>机器学习</code> <code>深度学习入门</code></p><hr><p data-anchor-id="cdsk"><img src="http://upload-images.jianshu.io/upload_images/2256672-06627c71f0d8c0dc.jpg" alt=""></p><blockquote data-anchor-id="tdyo" class="white-blockquote">
  <p>无论即将到来的是大数据时代还是人工智能时代，亦或是传统行业使用人工智能在云上处理大数据的时代，作为一个有理想有追求的程序员，不懂深度学习（Deep Learning）这个超热的技术，会不会感觉马上就out了？现在救命稻草来了，《零基础入门深度学习》系列文章旨在讲帮助爱编程的你从零基础达到入门级水平。零基础意味着你不需要太多的数学知识，只要会写程序就行了，没错，这是专门为程序员写的文章。虽然文中会有很多公式你也许看不懂，但同时也会有更多的代码，程序员的你一定能看懂的（我周围是一群狂热的Clean Code程序员，所以我写的代码也不会很差）。</p>
</blockquote><div class="md-section-divider"></div><h2 data-anchor-id="zy0s" id="文章列表">文章列表</h2><p data-anchor-id="rb6q"><a href="https://www.zybuluo.com/hanbingtao/note/433855" target="_blank">零基础入门深度学习(1) - 感知器</a> <br>
<a href="https://www.zybuluo.com/hanbingtao/note/448086" target="_blank">零基础入门深度学习(2) - 线性单元和梯度下降</a> <br>
<a href="https://www.zybuluo.com/hanbingtao/note/476663" target="_blank">零基础入门深度学习(3) - 神经网络和反向传播算法</a> <br>
<a href="https://www.zybuluo.com/hanbingtao/note/485480" target="_blank">零基础入门深度学习(4) - 卷积神经网络</a> <br>
<a href="https://zybuluo.com/hanbingtao/note/541458" target="_blank">零基础入门深度学习(5) - 循环神经网络</a> <br>
<a href="https://zybuluo.com/hanbingtao/note/581764" target="_blank">零基础入门深度学习(6) - 长短时记忆网络(LSTM)</a> <br>
<a href="https://zybuluo.com/hanbingtao/note/626300" target="_blank">零基础入门深度学习(7) - 递归神经网络</a></p><div class="md-section-divider"></div><h2 data-anchor-id="bkiz" id="往期回顾">往期回顾</h2><p data-anchor-id="vhth">在前面的文章中，我们介绍了<strong>循环神经网络</strong>，它可以用来处理包含序列结构的信息。然而，除此之外，信息往往还存在着诸如树结构、图结构等更复杂的结构。对于这种复杂的结构，<strong>循环神经网络</strong>就无能为力了。本文介绍一种更为强大、复杂的神经网络：<strong>递归神经网络 (Recursive Neural Network, RNN)</strong>，以及它的训练算法<strong>BPTS (Back Propagation Through Structure)</strong>。顾名思义，<strong>递归神经网络</strong>（巧合的是，它的缩写和<strong>循环神经网络</strong>一样，也是RNN）可以处理诸如树、图这样的<strong>递归结构</strong>。在文章的最后，我们将实现一个<strong>递归神经网络</strong>，并介绍它的几个应用场景。</p><div class="md-section-divider"></div><h2 data-anchor-id="okoy" id="递归神经网络是啥">递归神经网络是啥</h2><p data-anchor-id="p92h">因为神经网络的输入层单元个数是固定的，因此必须用循环或者递归的方式来处理长度可变的输入。<strong>循环神经网络</strong>实现了前者，通过将长度不定的输入分割为等长度的小块，然后再依次的输入到网络中，从而实现了神经网络对变长输入的处理。一个典型的例子是，当我们处理一句话的时候，我们可以把一句话看作是词组成的序列，然后，每次向<strong>循环神经网络</strong>输入一个词，如此循环直至整句话输入完毕，<strong>循环神经网络</strong>将产生对应的输出。如此，我们就能处理任意长度的句子了。入下图所示：</p><p data-anchor-id="yzfv"><img src="http://upload-images.jianshu.io/upload_images/2256672-a87286a58fc03563.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="p878">然而，有时候把句子看做是词的序列是不够的，比如下面这句话『两个外语学院的学生』：</p><p data-anchor-id="ok00"><img src="http://upload-images.jianshu.io/upload_images/2256672-1d69d9ea35f55af0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="c8xp">上图显示了这句话的两个不同的语法解析树。可以看出来这句话有歧义，不同的语法解析树则对应了不同的意思。一个是『两个外语学院的/学生』，也就是学生可能有许多，但他们来自于两所外语学校；另一个是『两个/外语学院的学生』，也就是只有两个学生，他们是外语学院的。为了能够让模型区分出两个不同的意思，我们的模型必须能够按照树结构去处理信息，而不是序列，这就是<strong>递归神经网络</strong>的作用。当面对按照树/图结构处理信息更有效的任务时，<strong>递归神经网络</strong>通常都会获得不错的结果。</p><p data-anchor-id="s576"><strong>递归神经网络</strong>可以把一个树/图结构信息编码为一个向量，也就是把信息映射到一个语义向量空间中。这个语义向量空间满足某类性质，比如语义相似的向量距离更近。也就是说，如果两句话（尽管内容不同）它的意思是相似的，那么把它们分别编码后的两个向量的距离也相近；反之，如果两句话的意思截然不同，那么编码后向量的距离则很远。如下图所示：</p><p data-anchor-id="1pik"><img src="http://upload-images.jianshu.io/upload_images/2256672-712ec37a73b854c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p data-anchor-id="dnii">从上图我们可以看到，<strong>递归神经网络</strong>将所有的词、句都映射到一个2维向量空间中。句子『the country of my birth』和句子『the place where I was born』的意思是非常接近的，所以表示它们的两个向量在向量空间中的距离很近。另外两个词『Germany』和『France』因为表示的都是地点，它们的向量与上面两句话的向量的距离，就比另外两个表示时间的词『Monday』和『Tuesday』的向量的距离近得多。这样，通过向量的距离，就得到了一种语义的表示。</p><p data-anchor-id="tjme">上图还显示了自然语言<strong>可组合</strong>的性质：词可以组成句、句可以组成段落、段落可以组成篇章，而更高层的语义取决于底层的语义以及它们的组合方式。<strong>递归神经网络</strong>是一种表示学习，它可以将词、句、段、篇按照他们的语义映射到同一个向量空间中，也就是把可组合（树/图结构）的信息表示为一个个有意义的向量。比如上面这个例子，<strong>递归神经网络</strong>把句子"the country of my birth"表示为二维向量[1,5]。有了这个『编码器』之后，我们就可以以这些有意义的向量为基础去完成更高级的任务（比如情感分析等）。如下图所示，<strong>递归神经网络</strong>在做情感分析时，可以比较好的处理否定句，这是胜过其他一些模型的：</p><p data-anchor-id="6soa"><img src="http://upload-images.jianshu.io/upload_images/2256672-1f91307ac606ba00.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="43rm">在上图中，蓝色表示正面评价，红色表示负面评价。每个节点是一个向量，这个向量表达了以它为根的子树的情感评价。比如"intelligent humor"是正面评价，而"care about cleverness wit or any other kind of intelligent humor"是中性评价。我们可以看到，模型能够正确的处理doesn't的含义，将正面评价转变为负面评价。</p><p data-anchor-id="u57h">尽管<strong>递归神经网络</strong>具有更为强大的表示能力，但是在实际应用中并不太流行。其中一个主要原因是，<strong>递归神经网络</strong>的输入是树/图结构，而这种结构需要花费很多人工去标注。想象一下，如果我们用<strong>循环神经网络</strong>处理句子，那么我们可以直接把句子作为输入。然而，如果我们用<strong>递归神经网络</strong>处理句子，我们就必须把每个句子标注为语法解析树的形式，这无疑要花费非常大的精力。很多时候，相对于<strong>递归神经网络</strong>能够带来的性能提升，这个投入是不太划算的。</p><p data-anchor-id="wv0g">我们已经基本了解了<strong>递归神经网络</strong>是做什么用的，接下来，我们将探讨它的算法细节。</p><div class="md-section-divider"></div><h2 data-anchor-id="wz4s" id="递归神经网络的前向计算">递归神经网络的前向计算</h2><p data-anchor-id="0c9c">接下来，我们详细介绍一下<strong>递归神经网络</strong>是如何处理树/图结构的信息的。在这里，我们以处理树型信息为例进行介绍。</p><p data-anchor-id="bsww"><strong>递归神经网络</strong>的输入是两个子节点（也可以是多个），输出就是将这两个子节点编码后产生的父节点，父节点的维度和每个子节点是相同的。如下图所示：</p><p data-anchor-id="zuf1"><img src="http://upload-images.jianshu.io/upload_images/2256672-f2ea8885320110a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="cqja"><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1">\mathbf{c}_1</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">\mathbf{c}_2</script>分别是表示两个子节点的向量，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 639.5 684.4001387359851" style="width: 1.452ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3">\mathbf{p}</script>是表示父节点的向量。子节点和父节点组成一个全连接神经网络，也就是子节点的每个神经元都和父节点的每个神经元两两相连。我们用矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1048.5 745.4001387359851" style="width: 2.419ex; height: 1.694ex; vertical-align: -0.242ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4">W</script>表示这些连接上的权重，它的维度将是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 2770.4444444444443 744.4001387359851" style="width: 6.411ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-D7" x="745" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1746" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64" x="2246" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5">d\times 2d</script>，其中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 523.5 744.4001387359851" style="width: 1.21ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6">d</script>表示每个节点的维度。父节点的计算公式可以写成：</p><div class="md-section-divider"></div><p data-anchor-id="u8wm"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1469.7000693679925 14186.337214538518 2439.400138735985" style="width: 32.903ex; height: 5.685ex; vertical-align: -2.298ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="917" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74" x="1973" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="2335" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="2864" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68" x="3465" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="4041" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="4431" y="0"></use><g transform="translate(5479,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-5B"></use><g transform="translate(695,0)"><g transform="translate(-15,0)"><g transform="translate(0,550)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="723" y="-213"></use></g><g transform="translate(0,-650)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="723" y="-213"></use></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-5D" x="1813" y="-1"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="8043" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="9044" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="9684" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="12073" y="0"></use><g transform="translate(12463,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="13296" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="13796" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">
\mathbf{p} = tanh(W\begin{bmatrix}\mathbf{c}_1\\\mathbf{c}_2\end{bmatrix}+\mathbf{b})\qquad(式1)
</script></p><p data-anchor-id="d04d">在上式中，tanh是激活函数（当然也可以用其它的激活函数），<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 639.5 740.4001387359851" style="width: 1.452ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8">\mathbf{b}</script>是偏置项，它也是一个维度为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 523.5 744.4001387359851" style="width: 1.21ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9">d</script>的向量。如果读过前面的文章，相信大家已经非常熟悉这些计算了，在此不做过多的解释了。</p><p data-anchor-id="g0mn">然后，我们把产生的父节点的向量和其他子节点的向量再次作为网络的输入，再次产生它们的父节点。如此递归下去，直至整棵树处理完毕。最终，我们将得到根节点的向量，我们可以认为它是对整棵树的表示，这样我们就实现了把树映射为一个向量。在下图中，我们使用<strong>递归神经网络</strong>处理一棵树，最终得到的向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 1093.406943983867 736.0189337626031" style="width: 2.54ex; height: 1.694ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="904" y="-326"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10">\mathbf{p}_3</script>，就是对整棵树的表示：</p><p data-anchor-id="d9f4"><img src="http://upload-images.jianshu.io/upload_images/2256672-2e300754026038f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="ey9y">举个例子，我们使用<strong>递归神将网络</strong>将『两个外语学校的学生』映射为一个向量，如下图所示：</p><p data-anchor-id="l5vn"><img src="http://upload-images.jianshu.io/upload_images/2256672-577b3ccc7c34eb34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p data-anchor-id="bk00">最后得到的向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 1093.406943983867 736.0189337626031" style="width: 2.54ex; height: 1.694ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="904" y="-326"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11">\mathbf{p}_3</script>就是对整个句子『两个外语学校的学生』的表示。由于整个结构是递归的，不仅仅是根节点，事实上每个节点都是以其为根的子树的表示。比如，在左边的这棵树中，向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 1093.406943983867 720.462584576499" style="width: 2.54ex; height: 1.694ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="904" y="-326"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12">\mathbf{p}_2</script>是短语『外语学院的学生』的表示，而向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 1093.406943983867 720.462584576499" style="width: 2.54ex; height: 1.694ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="904" y="-326"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13">\mathbf{p}_1</script>是短语『外语学院的』的表示。</p><p data-anchor-id="6msr"><strong>式1</strong>就是<strong>递归神经网络</strong>的前向计算算法。它和全连接神经网络的计算没有什么区别，只是在输入的过程中需要根据输入的树结构依次输入每个子节点。</p><p data-anchor-id="if0a">需要特别注意的是，<strong>递归神经网络</strong>的权重<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1048.5 745.4001387359851" style="width: 2.419ex; height: 1.694ex; vertical-align: -0.242ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14">W</script>和偏置项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 639.5 740.4001387359851" style="width: 1.452ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15">\mathbf{b}</script>在所有的节点都是<strong>共享</strong>的。</p><div class="md-section-divider"></div><h2 data-anchor-id="caa6" id="递归神经网络的训练">递归神经网络的训练</h2><p data-anchor-id="aoz0"><strong>递归神经网络</strong>的训练算法和<strong>循环神经网络</strong>类似，两者不同之处在于，前者需要将残差<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.2000693679926 451.5 767.4001387359851" style="width: 1.089ex; height: 1.815ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16">\delta</script>从根节点反向传播到各个子节点，而后者是将残差<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.2000693679926 451.5 767.4001387359851" style="width: 1.089ex; height: 1.815ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17">\delta</script>从当前时刻<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -646.2000693679926 830.2561863887845 823.8854201102238" style="width: 1.935ex; height: 1.935ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="511" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18">t_k</script>反向传播到初始时刻<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -646.2000693679926 815.406943983867 816.1072455171717" style="width: 1.935ex; height: 1.935ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="511" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19">t_1</script>。 </p><p data-anchor-id="ea5o">下面，我们介绍适用于<strong>递归神经网络</strong>的训练算法，也就是<strong>BPTS</strong>算法。</p><div class="md-section-divider"></div><h3 data-anchor-id="ehg7" id="误差项的传递">误差项的传递</h3><p data-anchor-id="4pug">首先，我们先推导将误差从父节点传递到子节点的公式，如下图：</p><p data-anchor-id="y897"><img src="http://upload-images.jianshu.io/upload_images/2256672-9ab001431eb2f2a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p data-anchor-id="kblf">定义<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.2000693679926 900.5282643274268 1044.2859610673618" style="width: 2.056ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20">\delta_p</script>为误差函数E相对于父节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -463.20006936799257 542 677.4001387359851" style="width: 1.21ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21">p</script>的加权输入<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2070.5282643274268 962.2859610673619" style="width: 4.839ex; height: 2.177ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22">\mathbf{net}_p</script>的导数，即：</p><div class="md-section-divider"></div><p data-anchor-id="4ahi"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1411.7080693679925 5543.410080628286 2405.0018239705873" style="width: 12.823ex; height: 5.565ex; vertical-align: -2.419ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-213"></use><g transform="translate(1178,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="155" y="0"></use><g transform="translate(0,624)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="523" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66" x="990" y="0"></use></g></g><g transform="translate(2665,0)"><rect stroke="none" width="2758" height="60" x="0" y="220"></rect><g transform="translate(713,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-213"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">
\delta_p\overset{def}{=}\frac{\partial{E}}{\partial{\mathbf{net}_p}}
</script></p><p data-anchor-id="ecsx">设<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2070.5282643274268 962.2859610673619" style="width: 4.839ex; height: 2.177ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24">\mathbf{net}_p</script>是父节点的<strong>加权输入</strong>，则</p><p data-anchor-id="p9pe"><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1469.7000693679925 8657.5351562853 2439.400138735985" style="width: 20.081ex; height: 5.685ex; vertical-align: -2.298ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="2348" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="3404" y="0"></use><g transform="translate(4453,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-5B"></use><g transform="translate(695,0)"><g transform="translate(-15,0)"><g transform="translate(0,550)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="723" y="-213"></use></g><g transform="translate(0,-650)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="723" y="-213"></use></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-5D" x="1813" y="-1"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="7017" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="8018" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25">\mathbf{net}_p=W\begin{bmatrix}\mathbf{c}_1\\\mathbf{c}_2\end{bmatrix}+\mathbf{b}</script></p><p data-anchor-id="wqhn">在上述式子里，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2070.5282643274268 962.2859610673619" style="width: 4.839ex; height: 2.177ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26">\mathbf{net}_p</script>、<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27">\mathbf{c}_1</script>、<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-28">\mathbf{c}_2</script>都是向量，而<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1048.5 745.4001387359851" style="width: 2.419ex; height: 1.694ex; vertical-align: -0.242ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29">W</script>是矩阵。为了看清楚它们的关系，我们将其展开：</p><div class="md-section-divider"></div><p data-anchor-id="u1pt"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -4969.200069367993 44270.673387096766 9438.400138735986" style="width: 102.823ex; height: 21.895ex; vertical-align: -10.524ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(3371,0)"><g transform="translate(-15,0)"><g transform="translate(0,2679)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-3106.0245061782125) scale(1,2.247138484540983)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-4215"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(25,1879)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="600" y="0"></use><g transform="translate(1067,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><g transform="translate(361,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use></g></g></g><g transform="translate(25,539)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="600" y="0"></use><g transform="translate(1067,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><g transform="translate(361,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use></g></g></g><g transform="translate(543,-661)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-1861)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="600" y="0"></use><g transform="translate(1067,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><g transform="translate(361,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use></g></g></g></g></g><g transform="translate(3242,2679)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-3106.0245061782125) scale(1,2.247138484540983)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-4215"></use></g></g><g transform="translate(4173,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><g transform="translate(0,2609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-2965.871110705) scale(1,2.014711626376451)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-4074"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g><g transform="translate(626,-591)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g></g><g transform="translate(3406,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g></g><g transform="translate(6828,0)"><g transform="translate(0,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g></g><g transform="translate(8996,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g></g><g transform="translate(12468,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g></g><g transform="translate(15889,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g></g><g transform="translate(19310,0)"><g transform="translate(0,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g></g><g transform="translate(21479,0)"><g transform="translate(25,1809)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g><g transform="translate(25,609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use><g transform="translate(676,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g><g transform="translate(0,-1791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use><g transform="translate(726,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g></g></g><g transform="translate(24952,2609)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-2965.871110705) scale(1,2.014711626376451)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-4074"></use></g></g><g transform="translate(26675,0)"><g transform="translate(0,4950)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-7639.235099337748) scale(1,9.764900662251655)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-8755"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(35,4150)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g transform="translate(35,2950)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(71,1750)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,550)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g><g transform="translate(35,-650)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g transform="translate(35,-1850)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(71,-3050)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-4250)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="500" y="0"></use></g></g></g></g><g transform="translate(2299,4950)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-7639.235099337748) scale(1,9.764900662251655)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-8755"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="29864" y="0"></use><g transform="translate(30865,0)"><g transform="translate(0,2720)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-3187.3251413726084) scale(1,2.3819654085781234)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-4296"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(142,1625)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="607" y="-213"></use></g><g transform="translate(142,379)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="607" y="-213"></use></g><g transform="translate(0,-821)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(107,-2021)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="607" y="-213"></use></g></g></g><g transform="translate(2155,2720)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-3187.3251413726084) scale(1,2.3819654085781234)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-4296"></use></g></g></g></g><g transform="translate(42191,0)"><g id="mjx-eqn-1"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">
\begin{align}
\begin{bmatrix}
net_{p_1}\\
net_{p_2}\\
...\\
net_{p_n}
\end{bmatrix}&=
\begin{bmatrix}
w_{p_1c_{11}}&w_{p_1c_{12}}&...&w_{p_1c_{1n}}&w_{p_1c_{21}}&w_{p_1c_{22}}&...&w_{p_1c_{2n}}\\
w_{p_2c_{11}}&w_{p_2c_{12}}&...&w_{p_2c_{1n}}&w_{p_2c_{21}}&w_{p_2c_{22}}&...&w_{p_2c_{2n}}\\
...\\
w_{p_nc_{11}}&w_{p_nc_{12}}&...&w_{p_nc_{1n}}&w_{p_nc_{21}}&w_{p_nc_{22}}&...&w_{p_nc_{2n}}\\
\end{bmatrix}
\begin{bmatrix}
c_{11}\\
c_{12}\\
...\\
c_{1n}\\
c_{21}\\
c_{22}\\
...\\
c_{2n}
\end{bmatrix}+\begin{bmatrix}\\
b_1\\
b_2\\
...\\
b_n\\
\end{bmatrix}
\end{align}
</script></p><p data-anchor-id="xmr8">在上面的公式中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -463.20006936799257 886.3053928999522 677.4001387359851" style="width: 2.056ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-31">p_i</script>表示父节点p的第i个分量；<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 1131.7123368838193 639.8854201102238" style="width: 2.661ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-32">c_{1i}</script>表示<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 887.406943983867 632.1072455171717" style="width: 2.056ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33">c_1</script>子节点的第i个分量；<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 1131.7123368838193 639.8854201102238" style="width: 2.661ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-34">c_{2i}</script>表示<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 887.406943983867 632.1072455171717" style="width: 2.056ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-35">c_2</script>子节点的第i个分量；<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 2260.230410209105 840.9661559139673" style="width: 5.202ex; height: 1.935ex; vertical-align: -0.968ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-326"></use><g transform="translate(599,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-36">w_{p_ic_{jk}}</script>表示子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 825.1815472394509 776.3570288792274" style="width: 1.935ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37">c_j</script>的第k个分量到父节点p的第i个分量的的权重。根据上面展开后的矩阵乘法形式，我们不难看出，对于子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 1193.9377336282355 776.3570288792274" style="width: 2.782ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-38">c_{jk}</script>来说，它会影响父节点所有的分量。因此，我们求误差函数E对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 1193.9377336282355 776.3570288792274" style="width: 2.782ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-39">c_{jk}</script>的导数时，必须用到全导数公式，也就是：</p><div class="md-section-divider"></div><p data-anchor-id="0mvb"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -2841.502882505027 44270.673387096766 5183.005765010054" style="width: 102.823ex; height: 12.097ex; vertical-align: -5.565ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(16637,0)"><g transform="translate(-15,0)"><g transform="translate(0,1317)"><g transform="translate(120,0)"><rect stroke="none" width="1881" height="60" x="0" y="220"></rect><g transform="translate(274,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></g></g></g></g><g transform="translate(2385,0)"><g transform="translate(0,1317)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="848" y="-1536"></use></g><g transform="translate(2667,0)"><g transform="translate(120,0)"><rect stroke="none" width="2815" height="60" x="0" y="220"></rect><g transform="translate(741,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="600" y="0"></use><g transform="translate(1067,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><g transform="translate(361,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-326"></use></g></g></g></g></g></g><g transform="translate(6009,0)"><rect stroke="none" width="2815" height="60" x="0" y="220"></rect><g transform="translate(60,789)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="600" y="0"></use><g transform="translate(1067,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74"></use><g transform="translate(361,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-326"></use></g></g></g></g><g transform="translate(527,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></g></g></g><g transform="translate(0,-1129)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="848" y="-1536"></use></g><g transform="translate(2667,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-326"></use></g></g><g transform="translate(3811,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="712" y="-326"></use><g transform="translate(599,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="412" y="0"></use></g></g></g></g></g></g></g><g transform="translate(42191,0)"><g transform="translate(0,1317)"><g id="mjx-eqn-2"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(0,-1129)"><g id="mjx-eqn-3"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">
\begin{align}
\frac{\partial{E}}{\partial{c_{jk}}}&=\sum_i{\frac{\partial{E}}{\partial{net_{p_i}}}}\frac{\partial{net_{p_i}}}{\partial{c_{jk}}}\\
&=\sum_i{\delta_{p_i}}w_{p_ic_{jk}}
\end{align}
</script></p><p data-anchor-id="vmtd">有了上式，我们就可以把它表示为矩阵形式，从而得到一个向量化表达：</p><div class="md-section-divider"></div><p data-anchor-id="eh65"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1456.0364458912265 44270.673387096766 2412.072891782453" style="width: 102.823ex; height: 5.565ex; vertical-align: -2.298ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(19739,0)"><g transform="translate(-15,0)"><g transform="translate(0,44)"><g transform="translate(120,0)"><rect stroke="none" width="1590" height="60" x="0" y="220"></rect><g transform="translate(129,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></g></g></g></g><g transform="translate(2094,0)"><g transform="translate(0,44)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use></g><g transform="translate(2131,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-213"></use></g></g></g></g><g transform="translate(42191,0)"><g transform="translate(0,44)"><g id="mjx-eqn-4"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-34" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">
\begin{align}
\frac{\partial{E}}{\partial{\mathbf{c}_j}}&=U_j\delta_p
\end{align}
</script></p><p data-anchor-id="ceyp">其中，矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1075.181547239451 1017.3570288792274" style="width: 2.54ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-42">U_j</script>是从矩阵W中提取部分元素组成的矩阵。其单元为：</p><div class="md-section-divider"></div><p data-anchor-id="yebw"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-135-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 5062.678191122766 840.9661559139673" style="width: 11.734ex; height: 1.935ex; vertical-align: -0.968ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75"></use><g transform="translate(572,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><g transform="translate(291,-170)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="345" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1746" y="0"></use><g transform="translate(2802,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="712" y="-326"></use><g transform="translate(687,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(306,-107)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="412" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">
u_{j_{ik}}=w_{p_kc_{ji}}
</script></p><p data-anchor-id="zz6h">上式看上去可能会让人晕菜，从下图，我们可以直观的看到<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1075.181547239451 1017.3570288792274" style="width: 2.54ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44">U_j</script>到底是啥。首先我们把W矩阵拆分为两个矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1398.406943983867 873.1072455171717" style="width: 3.266ex; height: 2.056ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1335" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-45">W_1</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1398.406943983867 873.1072455171717" style="width: 3.266ex; height: 2.056ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1335" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-46">W_2</script>，如下图所示：</p><p data-anchor-id="xh4f"><img src="http://upload-images.jianshu.io/upload_images/2256672-fb58d74fbc7e9ce5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p data-anchor-id="e3bc">显然，子矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1398.406943983867 873.1072455171717" style="width: 3.266ex; height: 2.056ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1335" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47">W_1</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1398.406943983867 873.1072455171717" style="width: 3.266ex; height: 2.056ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1335" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-48">W_2</script>分别对应子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-49">\mathbf{c}_1</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 965.406943983867 643.1072455171717" style="width: 2.298ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-50">\mathbf{c}_2</script>的到父节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -470.20006936799257 639.5 684.4001387359851" style="width: 1.452ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-70"></use></g></svg></span><script type="math/tex" id="MathJax-Element-51">\mathbf{p}</script>权重。则矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1075.181547239451 1017.3570288792274" style="width: 2.54ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-52">U_j</script>为：</p><div class="md-section-divider"></div><p data-anchor-id="bi8h"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-53-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -843.7687737936584 4087.1438301409294 1311.5872224503876" style="width: 9.435ex; height: 3.024ex; vertical-align: -1.21ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1352" y="0"></use><g transform="translate(2409,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1526" y="488"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="1335" y="-430"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-53">
U_j=W_j^T
</script></p><p data-anchor-id="lnm7">也就是说，将误差项反向传递到相应子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 903.1815472394509 787.3570288792274" style="width: 2.056ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-54">\mathbf{c}_j</script>的矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1075.181547239451 1017.3570288792274" style="width: 2.54ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-55"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="966" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-55">U_j</script>就是其对应权重矩阵<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1336.181547239451 1017.3570288792274" style="width: 3.145ex; height: 2.419ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="1335" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-56">W_j</script>的转置。</p><p data-anchor-id="bh54">现在，我们设<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2297.991467763023 1032.9661559139672" style="width: 5.323ex; height: 2.419ex; vertical-align: -0.968ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-57">\mathbf{net}_{c_j}</script>是子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 903.1815472394509 787.3570288792274" style="width: 2.056ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-58">\mathbf{c}_j</script>的加权输入，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -725.2000693679926 550.5 950.4001387359851" style="width: 1.331ex; height: 2.177ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use></g></svg></span><script type="math/tex" id="MathJax-Element-59">f</script>是子节点c的激活函数，则：</p><div class="md-section-divider"></div><p data-anchor-id="6h94"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-60-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -848.4830779569837 44270.673387096766 1196.9661559139674" style="width: 102.823ex; height: 2.782ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(19377,0)"><g transform="translate(-15,0)"><g transform="translate(0,29)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1180" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66" x="2237" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2787" y="0"></use><g transform="translate(3177,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="5475" y="0"></use></g></g></g><g transform="translate(42191,0)"><g transform="translate(0,29)"><g id="mjx-eqn-5"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">
\begin{align}
\mathbf{c}_j=f(\mathbf{net}_{c_j})\\
\end{align}
</script></p><p data-anchor-id="tvez">这样，我们得到：</p><div class="md-section-divider"></div><p data-anchor-id="2bmb"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-61-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -3687.403867829636 44270.673387096766 6874.807735659272" style="width: 102.823ex; height: 15.968ex; vertical-align: -7.5ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(17346,0)"><g transform="translate(-15,0)"><g transform="translate(0,2275)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g></g><g transform="translate(1391,0)"><g transform="translate(0,2275)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1176,0)"><rect stroke="none" width="2985" height="60" x="0" y="220"></rect><g transform="translate(826,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g></g></g></g><g transform="translate(0,-551)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1176,0)"><rect stroke="none" width="1590" height="60" x="0" y="220"></rect><g transform="translate(129,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></g></g><g transform="translate(3173,0)"><rect stroke="none" width="2985" height="60" x="0" y="220"></rect><g transform="translate(757,765)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g></g></g></g><g transform="translate(0,-2720)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1526" y="488"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="1335" y="-430"></use></g><g transform="translate(2734,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2218" x="3856" y="0"></use><g transform="translate(4579,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2032" x="804" y="583"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="5443" y="0"></use><g transform="translate(5832,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="8130" y="0"></use></g></g></g><g transform="translate(42191,0)"><g transform="translate(0,2275)"><g id="mjx-eqn-6"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-36" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(0,-551)"><g id="mjx-eqn-7"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-37" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(0,-2720)"><g id="mjx-eqn-8"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-38" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">
\begin{align}
\delta_{c_j}&=\frac{\partial{E}}{\partial{\mathbf{net}_{c_j}}}\\
&=\frac{\partial{E}}{\partial{\mathbf{c}_j}}\frac{\partial{\mathbf{c}_j}}{\partial{\mathbf{net}_{c_j}}}\\
&=W_j^T\delta_p\circ f'(\mathbf{net}_{c_j})
\end{align}
</script></p><p data-anchor-id="lrn1">如果我们将不同子节点<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -473.20006936799257 903.1815472394509 787.3570288792274" style="width: 2.056ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="723" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-62">\mathbf{c}_j</script>对应的误差项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.2000693679926 1127.9914677630231 1114.9661559139674" style="width: 2.661ex; height: 2.54ex; vertical-align: -0.968ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="613" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-63">\delta_{c_j}</script>连接成一个向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1769.7000693679925 4843.677760936953 3039.400138735985" style="width: 11.25ex; height: 7.016ex; vertical-align: -3.024ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="628" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1128" y="0"></use><g transform="translate(2185,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-5B"></use><g transform="translate(750,0)"><g transform="translate(-15,0)"><g transform="translate(0,665)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-213"></use></g></g><g transform="translate(0,-709)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-213"></use></g></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-5D" x="2075" y="-1"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-64">\delta_c=\begin{bmatrix}\delta_{c_1}\\\delta_{c_2}\end{bmatrix}</script>。那么，上式可以写成：</p><div class="md-section-divider"></div><p data-anchor-id="651r"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-65-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -911.5104670124718 13484.684811759626 1321.334125090142" style="width: 31.331ex; height: 3.024ex; vertical-align: -1.089ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="628" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1128" y="0"></use><g transform="translate(2185,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1526" y="583"></use></g><g transform="translate(3862,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2218" x="4985" y="0"></use><g transform="translate(5708,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2032" x="804" y="583"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="6571" y="0"></use><g transform="translate(6961,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="2283" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="8982" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="11371" y="0"></use><g transform="translate(11761,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="12594" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="13095" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">
\delta_c=W^T\delta_p\circ f'(\mathbf{net}_c)\qquad(式2)
</script></p><p data-anchor-id="ih9x"><strong>式2</strong>就是将误差项从父节点传递到其子节点的公式。注意，上式中的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-66-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2021.0307896443683 833.5925268914102" style="width: 4.718ex; height: 1.935ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="2283" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-66">\mathbf{net}_c</script>也是将两个子节点的加权输入<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-67-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2341.991467763023 930.9661559139672" style="width: 5.444ex; height: 2.177ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-67">\mathbf{net}_{c_1}</script>和<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-68-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -655.2000693679926 2341.991467763023 930.9661559139672" style="width: 5.444ex; height: 2.177ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-68">\mathbf{net}_{c_2}</script>连在一起的向量。</p><p data-anchor-id="puyw">有了传递一层的公式，我们就不难写出逐层传递的公式。</p><p data-anchor-id="tn63"><img src="http://upload-images.jianshu.io/upload_images/2256672-02c71c9fade90557.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p data-anchor-id="vucz">上图是在树型结构中反向传递误差项的全景图，反复应用<strong>式2</strong>，在已知<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-69-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1072.1642641169133 1458.3931265281876 1378.7623666631098" style="width: 3.387ex; height: 3.145ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g></svg></span><script type="math/tex" id="MathJax-Element-69">\delta_p^{(3)}</script>的情况下，我们不难算出<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-70-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1072.1642641169133 1458.3931265281876 1378.7623666631098" style="width: 3.387ex; height: 3.145ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g></svg></span><script type="math/tex" id="MathJax-Element-70">\delta_p^{(1)}</script>为：</p><div class="md-section-divider"></div><p data-anchor-id="lyjt"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-136-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -3400.412314375415 29479.06016129032 6300.82462875083" style="width: 68.468ex; height: 14.637ex; vertical-align: -6.774ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9345,0)"><g transform="translate(-15,0)"><g transform="translate(0,2328)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(0,687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g><g transform="translate(0,-953)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(0,-2594)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g></g><g transform="translate(1721,0)"><g transform="translate(0,2328)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1526" y="583"></use></g><g transform="translate(2734,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2218" x="4414" y="0"></use><g transform="translate(5137,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2032" x="804" y="583"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="6000" y="0"></use><g transform="translate(6390,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="9009" y="0"></use></g><g transform="translate(0,687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5B" x="1056" y="0"></use><g transform="translate(1334,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(2793,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5D"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="393" y="-213"></use></g></g><g transform="translate(0,-953)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1526" y="583"></use></g><g transform="translate(2734,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2218" x="4414" y="0"></use><g transform="translate(5137,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2032" x="804" y="583"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="6000" y="0"></use><g transform="translate(6390,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="9009" y="0"></use></g><g transform="translate(0,-2594)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5B" x="1056" y="0"></use><g transform="translate(1334,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(2793,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5D"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="393" y="-213"></use></g></g></g></g><g transform="translate(26899,0)"><g transform="translate(0,2328)"><g id="mjx-eqn-23"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,687)"><g id="mjx-eqn-24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-34" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-953)"><g id="mjx-eqn-25"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-2594)"><g id="mjx-eqn-26"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-36" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-136">
\begin{align}
\delta^{(2)}&=W^T\delta_p^{(3)}\circ f'(\mathbf{net}^{(2)})\\
\delta_p^{(2)}&=[\delta^{(2)}]_p\\
\delta^{(1)}&=W^T\delta_p^{(2)}\circ f'(\mathbf{net}^{(1)})\\
\delta_p^{(1)}&=[\delta^{(1)}]_p\\
\end{align}
</script></p><p data-anchor-id="7ylm">在上面的公式中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1769.7000693679925 5737.441756585937 3039.400138735985" style="width: 13.306ex; height: 7.016ex; vertical-align: -3.024ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1736" y="0"></use><g transform="translate(2792,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-5B"></use><g transform="translate(750,0)"><g transform="translate(-15,0)"><g transform="translate(0,672)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="628" y="-211"></use></g><g transform="translate(0,-939)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-5D" x="2361" y="-1"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-72">\delta^{(2)}=\begin{bmatrix}\delta_c^{(2)}\\\delta_p^{(2)}\end{bmatrix}</script>，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-73-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.1292620390899 2471.4213908556144 1220.215153738459" style="width: 5.685ex; height: 2.782ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5B"></use><g transform="translate(278,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(1736,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-5D"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="393" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-73">[\delta^{(2)}]_p</script>表示取向量<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-74-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.1292620390899 1458.3931265281876 943.3293314070825" style="width: 3.387ex; height: 2.177ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-74">\delta^{(2)}</script>属于节点p的部分。</p><div class="md-section-divider"></div><h3 data-anchor-id="w6q5" id="权重梯度的计算">权重梯度的计算</h3><p data-anchor-id="5j3g">根据加权输入的计算公式：</p><div class="md-section-divider"></div><p data-anchor-id="olxf"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-75-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1072.1642641169133 8094.815113457011 1378.76236666311" style="width: 18.75ex; height: 3.145ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-212"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="2754" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="3810" y="0"></use><g transform="translate(4858,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><g transform="translate(511,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="6454" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="7455" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">
\mathbf{net}_p^{(l)}=W\mathbf{c}^{(l)}+\mathbf{b}
</script></p><p data-anchor-id="cjmn">其中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-76-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1072.1642641169133 2476.407556728505 1378.76236666311" style="width: 5.806ex; height: 3.145ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="2283" y="-212"></use></g></svg></span><script type="math/tex" id="MathJax-Element-76">\mathbf{net}_p^{(l)}</script>表示第l层的父节点的加权输入，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-77-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.1292620390899 1373.407556728505 939.3293314070825" style="width: 3.145ex; height: 2.177ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><g transform="translate(511,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-77">\mathbf{c}^{(l)}</script>表示第l层的子节点。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1048.5 745.4001387359851" style="width: 2.419ex; height: 1.694ex; vertical-align: -0.242ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use></g></svg></span><script type="math/tex" id="MathJax-Element-78">W</script>是权重矩阵，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-79-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 639.5 740.4001387359851" style="width: 1.452ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use></g></svg></span><script type="math/tex" id="MathJax-Element-79">\mathbf{b}</script>是偏置项。将其展开可得：</p><div class="md-section-divider"></div><p data-anchor-id="v65n"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-80-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -970.2000693679926 9467.129489391555 2183.656109255718" style="width: 22.016ex; height: 5.081ex; vertical-align: -2.903ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="2283" y="513"></use><g transform="translate(1614,-248)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="2625" y="0"></use><g transform="translate(3681,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="848" y="-1536"></use></g><g transform="translate(5292,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="412" y="0"></use></g><g transform="translate(1352,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="613" y="-430"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="7645" y="0"></use><g transform="translate(8645,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="607" y="-213"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">
\mathbf{net}_{p_j}^l=\sum_i{w_{ji}c_i^l}+b_j
</script></p><p data-anchor-id="j5a5">那么，我们可以求得误差函数在第l层对权重的梯度为：</p><div class="md-section-divider"></div><p data-anchor-id="evzf"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-81-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -2858.061447217172 44270.673387096766 5216.122894434344" style="width: 102.823ex; height: 12.097ex; vertical-align: -5.565ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(16902,0)"><g transform="translate(-15,0)"><g transform="translate(0,900)"><g transform="translate(120,0)"><rect stroke="none" width="2265" height="60" x="0" y="220"></rect><g transform="translate(466,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-304)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="412" y="0"></use></g></g></g></g></g></g><g transform="translate(2769,0)"><g transform="translate(0,900)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1176,0)"><rect stroke="none" width="3163" height="60" x="0" y="220"></rect><g transform="translate(915,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g></g></g><g transform="translate(4746,0)"><rect stroke="none" width="3163" height="60" x="0" y="220"></rect><g transform="translate(60,885)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g></g><g transform="translate(509,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-304)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="412" y="0"></use></g></g></g></g></g><g transform="translate(0,-1924)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g><g transform="translate(2371,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="613" y="-430"></use></g></g></g></g><g transform="translate(41690,0)"><g transform="translate(0,900)"><g id="mjx-eqn-13"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-1924)"><g id="mjx-eqn-14"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-34" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-81">
\begin{align}
\frac{\partial{E}}{\partial{w_{ji}^{(l)}}}&=\frac{\partial{E}}{\partial{\mathbf{net}_{p_j}^{(l)}}}\frac{\partial{\mathbf{net}_{p_j}^{(l)}}}{\partial{w_{ji}^{(l)}}}\\
&=\delta_{p_j}^{(l)}c_i^{(l)}\\
\end{align}
</script></p><p data-anchor-id="41tq">上式是针对一个权重项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 1352.486940139403 777.3570288792274" style="width: 3.145ex; height: 1.815ex; vertical-align: -0.847ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="412" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-82">w_{ji}</script>的公式，现在需要把它扩展为对所有的权重项的公式。我们可以把上式写成矩阵的形式（在下面的公式中，m=2n）：</p><div class="md-section-divider"></div><p data-anchor-id="c8pb"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" style="font-size: 100%; display: inline-block;"><span style="display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="display: inline-block; position: relative; width: 102.823ex; height: 51.411ex; vertical-align: -25.161ex;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -11349.614328476682 44270.673387096766 22199.228656953368" style="width: 102.823ex; height: 51.532ex; position: absolute; bottom: 0ex; left: 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(13378,0)"><g transform="translate(-15,0)"><g transform="translate(0,5122)"><g transform="translate(120,0)"><rect stroke="none" width="2629" height="60" x="0" y="220"></rect><g transform="translate(648,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><g transform="translate(1079,288)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></g></g></g></g><g transform="translate(3132,0)"><g transform="translate(0,5122)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><g transform="translate(0,6207)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-10150.158134103913) scale(1,13.928952129525559)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-11271"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(8,4815)"><g transform="translate(120,0)"><rect stroke="none" width="2265" height="60" x="0" y="220"></rect><g transform="translate(466,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g></g><g transform="translate(8,1683)"><g transform="translate(120,0)"><rect stroke="none" width="2265" height="60" x="0" y="220"></rect><g transform="translate(466,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g></g></g><g transform="translate(676,-1377)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-4369)"><g transform="translate(120,0)"><rect stroke="none" width="2282" height="60" x="0" y="220"></rect><g transform="translate(475,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="600" y="0"></use></g></g></g></g></g></g><g transform="translate(3508,0)"><g transform="translate(8,4815)"><g transform="translate(120,0)"><rect stroke="none" width="2265" height="60" x="0" y="220"></rect><g transform="translate(466,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g></g><g transform="translate(8,1683)"><g transform="translate(120,0)"><rect stroke="none" width="2265" height="60" x="0" y="220"></rect><g transform="translate(466,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></g></g></g><g transform="translate(0,-4369)"><g transform="translate(120,0)"><rect stroke="none" width="2282" height="60" x="0" y="220"></rect><g transform="translate(475,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="600" y="0"></use></g></g></g></g></g></g><g transform="translate(7030,0)"><g transform="translate(0,4815)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,1683)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-4369)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g></g><g transform="translate(9199,0)"><g transform="translate(35,4815)"><g transform="translate(120,0)"><rect stroke="none" width="2479" height="60" x="0" y="220"></rect><g transform="translate(573,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g></g></g><g transform="translate(35,1683)"><g transform="translate(120,0)"><rect stroke="none" width="2479" height="60" x="0" y="220"></rect><g transform="translate(573,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-308)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="500" y="0"></use></g></g></g></g></g><g transform="translate(0,-4369)"><g transform="translate(120,0)"><rect stroke="none" width="2549" height="60" x="0" y="220"></rect><g transform="translate(608,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><g transform="translate(716,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(716,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="600" y="0"></use></g></g></g></g></g></g></g><g transform="translate(12990,6207)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-10150.158134103913) scale(1,13.928952129525559)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-11271"></use></g></g></g><g transform="translate(0,-5291)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><g transform="translate(0,4405)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-6552.226417737933) scale(1,7.962232865237036)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-7667"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(0,3352)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use></g><g transform="translate(1315,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-435"></use></g></g><g transform="translate(0,1586)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use></g><g transform="translate(1315,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-435"></use></g></g><g transform="translate(517,-935)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-3588)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use></g><g transform="translate(1315,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="613" y="-435"></use></g></g></g><g transform="translate(3188,0)"><g transform="translate(149,3352)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use></g><g transform="translate(1315,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-435"></use></g></g><g transform="translate(149,1586)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use></g><g transform="translate(1315,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-435"></use></g></g><g transform="translate(0,-3588)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="1315" y="0"></use><g transform="translate(1614,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="613" y="-435"></use></g></g></g><g transform="translate(6690,0)"><g transform="translate(0,3352)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,1586)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-3588)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g></g><g transform="translate(8858,0)"><g transform="translate(25,3352)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="641" y="500"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use></g><g transform="translate(1221,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="613" y="-212"></use></g></g><g transform="translate(25,1586)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="641" y="500"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use></g><g transform="translate(1221,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="613" y="-212"></use></g></g><g transform="translate(0,-3588)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="641" y="500"></use><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use></g><g transform="translate(1271,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><g transform="translate(433,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="613" y="-212"></use></g></g></g></g><g transform="translate(12427,4405)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-6552.226417737933) scale(1,7.962232865237036)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-7667"></use></g></g></g><g transform="translate(0,-10440)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2371" y="0"></use><g transform="translate(2761,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-63"></use><g transform="translate(511,412)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g><g transform="translate(4134,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="550" y="583"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="7122" y="0"></use><g transform="translate(7511,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="8345" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="8845" y="0"></use></g></g></g><g transform="translate(41690,0)"><g transform="translate(0,5122)"><g id="mjx-eqn-15"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-5291)"><g id="mjx-eqn-16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-36" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-10440)"><g id="mjx-eqn-17"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-37" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g></g></g></svg></span></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-83">
\begin{align}
\frac{\partial{E}}{\partial{W^{(l)}}}&=
\begin{bmatrix}
\frac{\partial{E}}{\partial{w_{11}^{(l)}}}&
\frac{\partial{E}}{\partial{w_{12}^{(l)}}}&
...&
\frac{\partial{E}}{\partial{w_{1m}^{(l)}}}\\
\frac{\partial{E}}{\partial{w_{21}^{(l)}}}&
\frac{\partial{E}}{\partial{w_{22}^{(l)}}}&
...&
\frac{\partial{E}}{\partial{w_{2m}^{(l)}}}\\
\\\\\\...\\\\
\frac{\partial{E}}{\partial{w_{n1}^{(l)}}}&
\frac{\partial{E}}{\partial{w_{n2}^{(l)}}}&
...&
\frac{\partial{E}}{\partial{w_{nm}^{(l)}}}\\
\end{bmatrix}\\
&=
\begin{bmatrix}
\delta_{p_1}^{(l)}c_1^l&\delta_{p_1}^{(l)}c_2^l&...&\delta_{p_1}^lc_m^{(l)}\\
\delta_{p_2}^{(l)}c_1^l&\delta_{p_2}^{(l)}c_2^l&...&\delta_{p_2}^lc_m^{(l)}\\
\\\\\\...\\\\
\delta_{p_n}^{(l)}c_1^l&\delta_{p_n}^{(l)}lc_2^l&...&\delta_{p_n}^lc_m^{(l)}\\
\end{bmatrix}\\
&=\delta^{{(l)}}(\mathbf{c}^{(l)})^T\qquad(式3)
\end{align}
</script></p><p data-anchor-id="7edp"><strong>式3</strong>就是第l层权重项的梯度计算公式。我们知道，由于权重<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-84-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -703.2000693679926 1048.5 745.4001387359851" style="width: 2.419ex; height: 1.694ex; vertical-align: -0.242ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use></g></svg></span><script type="math/tex" id="MathJax-Element-84">W</script>是在所有层共享的，所以和<strong>循环神经网络</strong>一样，<strong>递归神经网络</strong>的最终的<strong>权重梯度是各个层权重梯度之和</strong>。即：</p><div class="md-section-divider"></div><p data-anchor-id="bb75"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-85-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1411.7080693679925 12069.876768198039 2649.912846597247" style="width: 28.065ex; height: 6.169ex; vertical-align: -3.024ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1736" height="60" x="0" y="220"></rect><g transform="translate(202,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="567" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="2253" y="0"></use><g transform="translate(3310,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="872" y="-1570"></use></g><g transform="translate(5041,0)"><rect stroke="none" width="2629" height="60" x="0" y="220"></rect><g transform="translate(648,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-791)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><g transform="translate(1079,288)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="9957" y="0"></use><g transform="translate(10346,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-34" x="11179" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="11680" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-85">
\frac{\partial{E}}{\partial{W}}=\sum_l\frac{\partial{E}}{\partial{W^{(l)}}}\qquad(式4)
</script></p><p data-anchor-id="0gyj">因为<strong>循环神经网络</strong>的证明过程已经在<a href="https://www.zybuluo.com/hanbingtao/note/485480" target="_blank">零基础入门深度学习(4) - 卷积神经网络</a>一文中给出，因此，<strong>递归神经网络</strong>『为什么最终梯度是各层梯度之和』的证明就留给读者自行完成啦。</p><p data-anchor-id="i2up">接下来，我们求偏置项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-86-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -714.2000693679926 639.5 740.4001387359851" style="width: 1.452ex; height: 1.694ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use></g></svg></span><script type="math/tex" id="MathJax-Element-86">\mathbf{b}</script>的梯度计算公式。先计算误差函数对第l层偏置项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-87-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -972.2176769687143 1501.407556728505 998.4177463367068" style="width: 3.508ex; height: 2.298ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use><g transform="translate(639,421)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-87">\mathbf{b}^{(l)}</script>的梯度：</p><div class="md-section-divider"></div><p data-anchor-id="iy1b"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-88-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -2858.061447217172 44270.673387096766 5216.122894434344" style="width: 102.823ex; height: 12.097ex; vertical-align: -5.565ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(17045,0)"><g transform="translate(-15,0)"><g transform="translate(0,900)"><g transform="translate(120,0)"><rect stroke="none" width="1978" height="60" x="0" y="220"></rect><g transform="translate(323,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><g transform="translate(429,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="607" y="-430"></use></g></g></g></g></g><g transform="translate(2482,0)"><g transform="translate(0,900)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1176,0)"><rect stroke="none" width="3163" height="60" x="0" y="220"></rect><g transform="translate(915,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g></g></g><g transform="translate(4746,0)"><rect stroke="none" width="3163" height="60" x="0" y="220"></rect><g transform="translate(60,885)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-6E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-65" x="639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-74" x="1167" y="0"></use><g transform="translate(1614,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(1614,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g></g><g transform="translate(652,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><g transform="translate(429,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="607" y="-430"></use></g></g></g></g><g transform="translate(0,-1924)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6A" x="712" y="-326"></use></g></g></g></g></g><g transform="translate(41690,0)"><g transform="translate(0,900)"><g id="mjx-eqn-18"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-38" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-1924)"><g id="mjx-eqn-19"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-39" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-88">
\begin{align}
\frac{\partial{E}}{\partial{b_j^{(l)}}}&=\frac{\partial{E}}{\partial{\mathbf{net}_{p_j}^{(l)}}}\frac{\partial{\mathbf{net}_{p_j}^{(l)}}}{\partial{b_j^{(l)}}}\\
&=\delta_{p_j}^{(l)}\\
\end{align}
</script></p><p data-anchor-id="oq9n">把上式扩展为矩阵的形式：</p><div class="md-section-divider"></div><p data-anchor-id="dz7v"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-89-Frame" style="font-size: 100%; display: inline-block;"><span style="display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="display: inline-block; position: relative; width: 102.823ex; height: 51.29ex; vertical-align: -25.04ex;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -11317.511248820243 44270.673387096766 22135.02249764049" style="width: 102.823ex; height: 51.411ex; position: absolute; bottom: 0ex; left: 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(17713,0)"><g transform="translate(-15,0)"><g transform="translate(0,5177)"><g transform="translate(120,0)"><rect stroke="none" width="2188" height="60" x="0" y="220"></rect><g transform="translate(428,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-924)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use><g transform="translate(639,421)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></g></g></g></g><g transform="translate(2692,0)"><g transform="translate(0,5177)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><g transform="translate(0,6120)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-9977.203795828094) scale(1,13.642129014640288)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-11097"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(0,4728)"><g transform="translate(120,0)"><rect stroke="none" width="1978" height="60" x="0" y="220"></rect><g transform="translate(323,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><g transform="translate(429,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="607" y="-435"></use></g></g></g></g><g transform="translate(0,1604)"><g transform="translate(120,0)"><rect stroke="none" width="1978" height="60" x="0" y="220"></rect><g transform="translate(323,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><g transform="translate(429,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="607" y="-435"></use></g></g></g></g><g transform="translate(525,-1448)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-4440)"><g transform="translate(120,0)"><rect stroke="none" width="1978" height="60" x="0" y="220"></rect><g transform="translate(323,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-1024)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62"></use><g transform="translate(429,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="607" y="-212"></use></g></g></g></g></g></g><g transform="translate(3206,6120)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-9977.203795828094) scale(1,13.642129014640288)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-11097"></use></g></g></g><g transform="translate(0,-5150)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><g transform="translate(0,4405)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use><g transform="translate(0,-6552.226417737933) scale(1,7.962232865237036)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A2"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A3" x="0" y="-7667"></use></g><g transform="translate(834,0)"><g transform="translate(-15,0)"><g transform="translate(0,3352)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="712" y="-326"></use></g></g><g transform="translate(0,1586)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-326"></use></g></g><g transform="translate(73,-935)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="445" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="890" y="0"></use></g><g transform="translate(0,-3588)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><g transform="translate(444,-150)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="712" y="-326"></use></g></g></g></g><g transform="translate(2302,4405)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use><g transform="translate(0,-6552.226417737933) scale(1,7.962232865237036)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A5"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A6" x="0" y="-7667"></use></g></g></g><g transform="translate(0,-10408)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D"></use><g transform="translate(1056,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use><g transform="translate(453,521)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="628" y="-212"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="4371" y="0"></use><g transform="translate(4761,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="5594" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6095" y="0"></use></g></g></g><g transform="translate(41690,0)"><g transform="translate(0,5177)"><g id="mjx-eqn-20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-5150)"><g id="mjx-eqn-21"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(0,-10408)"><g id="mjx-eqn-22"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="890" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1390" y="0"></use></g></g></g></g></svg></span></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-89">
\begin{align}
\frac{\partial{E}}{\partial{\mathbf{b}^{(l)}}}&=
\begin{bmatrix}
\frac{\partial{E}}{\partial{b_1^{(l)}}}\\
\frac{\partial{E}}{\partial{b_2^{(l)}}}\\
\\\\\\...\\\\
\frac{\partial{E}}{\partial{b_n^{(l)}}}\\
\end{bmatrix}\\
&=
\begin{bmatrix}
\delta_{p_1}^{(l)}\\
\delta_{p_2}^{(l)}\\
\\\\\\...\\\\
\delta_{p_n}^{(l)}\\
\end{bmatrix}\\
&=\delta_p^{{(l)}}\qquad(式5)
\end{align}
</script></p><p data-anchor-id="xtig"><strong>式5</strong>是第l层偏置项的梯度，那么最终的偏置项梯度是各个层偏置项梯度之和，即：</p><div class="md-section-divider"></div><p data-anchor-id="yrma"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-90-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1411.7080693679925 11345.626768198039 2649.912846597247" style="width: 26.371ex; height: 6.169ex; vertical-align: -3.024ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="1452" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(122,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="567" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1969" y="0"></use><g transform="translate(3026,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="872" y="-1570"></use></g><g transform="translate(4757,0)"><rect stroke="none" width="2188" height="60" x="0" y="220"></rect><g transform="translate(428,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-924)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><g transform="translate(567,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use><g transform="translate(639,421)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6C" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="688" y="0"></use></g></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="9232" y="0"></use><g transform="translate(9622,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(52.08314516129032) matrix(1 0 0 -1 0 0)">式</text></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-36" x="10455" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="10956" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-90">
\frac{\partial{E}}{\partial{\mathbf{b}}}=\sum_l\frac{\partial{E}}{\partial{\mathbf{b}^{(l)}}}\qquad(式6)
</script></p><div class="md-section-divider"></div><h3 data-anchor-id="1k2v" id="权重更新">权重更新</h3><p data-anchor-id="r11h">如果使用梯度下降优化算法，那么权重更新公式为：</p><div class="md-section-divider"></div><p data-anchor-id="ygag"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-91-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1411.7080693679925 7522.166666666667 2140.1160016392105" style="width: 17.419ex; height: 4.96ex; vertical-align: -1.815ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2190" x="1326" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="2604" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="3875" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B7" x="4876" y="0"></use><g transform="translate(5666,0)"><rect stroke="none" width="1736" height="60" x="0" y="220"></rect><g transform="translate(202,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(60,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-57" x="567" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-91">
W\gets W + \eta\frac{\partial{E}}{\partial{W}}
</script></p><p data-anchor-id="nwgf">其中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-92-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 503.5 699.4001387359851" style="width: 1.21ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B7"></use></g></svg></span><script type="math/tex" id="MathJax-Element-92">\eta</script>是学习速率常数。把<strong>式4</strong>带入到上式，即可完成权重的更新。同理，偏置项的更新公式为：</p><div class="md-section-divider"></div><p data-anchor-id="kdxx"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-93-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1411.7080693679925 6420.166666666667 2140.1160016392105" style="width: 14.879ex; height: 4.96ex; vertical-align: -1.815ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2190" x="917" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="2195" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="3057" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B7" x="4058" y="0"></use><g transform="translate(4848,0)"><rect stroke="none" width="1452" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="567" y="0"></use></g><g transform="translate(122,-687)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2202"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-62" x="567" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-93">
\mathbf{b}\gets \mathbf{b} + \eta\frac{\partial{E}}{\partial{\mathbf{b}}}
</script></p><p data-anchor-id="eq9h">把<strong>式6</strong>带入到上式，即可完成偏置项的更新。</p><p data-anchor-id="0i0x">这就是<strong>递归神经网络</strong>的训练算法BPTS。由于我们有了前面几篇文章的基础，相信读者们理解BPTS算法也会比较容易。</p><div class="md-section-divider"></div><h2 data-anchor-id="8mds" id="递归神经网络的实现">递归神经网络的实现</h2><blockquote data-anchor-id="ssy7" class="white-blockquote">
  <p>完整代码请参考GitHub: <a href="https://github.com/hanbt/learn_dl/blob/master/recursive.py" target="_blank">https://github.com/hanbt/learn_dl/blob/master/recursive.py</a> (python2.7)</p>
</blockquote><p data-anchor-id="qagq">现在，我们实现一个处理树型结构的<strong>递归神经网络</strong>。</p><p data-anchor-id="4z3o">在文件的开头，加入如下代码：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="5ydd" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="com">#!/usr/bin/env python</span></code></li><li class="L1"><code class="language-python"><span class="com"># -*- coding: UTF-8 -*-</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L5"><code class="language-python"><span class="kwd">from</span><span class="pln"> cnn </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">IdentityActivator</span></code></li></ol></pre><p data-anchor-id="7tde">上述四行代码非常简单，没有什么需要解释的。IdentityActivator激活函数是在我们介绍<strong>卷积神经网络</strong>时写的，现在引用一下它。</p><p data-anchor-id="ns3n">我们首先定义一个树节点结构，这样，我们就可以用它保存卷积神经网络生成的整棵树：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="r2ls" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">TreeNode</span><span class="pun">(</span><span class="pln">object</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">,</span><span class="pln"> children</span><span class="pun">=[],</span><span class="pln"> children_data</span><span class="pun">=[]):</span></code></li><li class="L2"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">parent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span></code></li><li class="L3"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">children </span><span class="pun">=</span><span class="pln"> children</span></code></li><li class="L4"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">children_data </span><span class="pun">=</span><span class="pln"> children_data</span></code></li><li class="L5"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> data</span></code></li><li class="L6"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> child </span><span class="kwd">in</span><span class="pln"> children</span><span class="pun">:</span></code></li><li class="L7"><code class="language-python"><span class="pln">            child</span><span class="pun">.</span><span class="pln">parent </span><span class="pun">=</span><span class="pln"> self</span></code></li></ol></pre><p data-anchor-id="l31e">接下来，我们把<strong>递归神经网络</strong>的实现代码都放在RecursiveLayer类中，下面是这个类的构造函数：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lbx1" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 递归神经网络实现</span></code></li><li class="L1"><code class="language-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">RecursiveLayer</span><span class="pun">(</span><span class="pln">object</span><span class="pun">):</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> node_width</span><span class="pun">,</span><span class="pln"> child_count</span><span class="pun">,</span><span class="pln"> </span></code></li><li class="L3"><code class="language-python"><span class="pln">                 activator</span><span class="pun">,</span><span class="pln"> learning_rate</span><span class="pun">):</span></code></li><li class="L4"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L5"><code class="language-python"><span class="str">        递归神经网络构造函数</span></code></li><li class="L6"><code class="language-python"><span class="str">        node_width: 表示每个节点的向量的维度</span></code></li><li class="L7"><code class="language-python"><span class="str">        child_count: 每个父节点有几个子节点</span></code></li><li class="L8"><code class="language-python"><span class="str">        activator: 激活函数对象</span></code></li><li class="L9"><code class="language-python"><span class="str">        learning_rate: 梯度下降算法学习率</span></code></li><li class="L0"><code class="language-python"><span class="str">        '''</span></code></li><li class="L1"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">node_width </span><span class="pun">=</span><span class="pln"> node_width</span></code></li><li class="L2"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">child_count </span><span class="pun">=</span><span class="pln"> child_count</span></code></li><li class="L3"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">activator </span><span class="pun">=</span><span class="pln"> activator</span></code></li><li class="L4"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">learning_rate </span><span class="pun">=</span><span class="pln"> learning_rate</span></code></li><li class="L5"><code class="language-python"><span class="pln">        </span><span class="com"># 权重数组W</span></code></li><li class="L6"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">W </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">uniform</span><span class="pun">(-</span><span class="lit">1e-4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1e-4</span><span class="pun">,</span></code></li><li class="L7"><code class="language-python"><span class="pln">            </span><span class="pun">(</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> node_width </span><span class="pun">*</span><span class="pln"> child_count</span><span class="pun">))</span></code></li><li class="L8"><code class="language-python"><span class="pln">        </span><span class="com"># 偏置项b</span></code></li><li class="L9"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">b </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros</span><span class="pun">((</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L0"><code class="language-python"><span class="pln">        </span><span class="com"># 递归神经网络生成的树的根节点</span></code></li><li class="L1"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">root </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span></code></li></ol></pre><p data-anchor-id="a2ps">下面是前向计算的实现：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1vp2" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> forward</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> </span><span class="pun">*</span><span class="pln">children</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L2"><code class="language-python"><span class="str">        前向计算</span></code></li><li class="L3"><code class="language-python"><span class="str">        '''</span></code></li><li class="L4"><code class="language-python"><span class="pln">        children_data </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">concatenate</span><span class="pun">(</span><span class="pln">children</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">        parent_data </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">activator</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span></code></li><li class="L6"><code class="language-python"><span class="pln">            np</span><span class="pun">.</span><span class="pln">dot</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">W</span><span class="pun">,</span><span class="pln"> children_data</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">b</span></code></li><li class="L7"><code class="language-python"><span class="pln">        </span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">root </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TreeNode</span><span class="pun">(</span><span class="pln">parent_data</span><span class="pun">,</span><span class="pln"> children</span></code></li><li class="L9"><code class="language-python"><span class="pln">                            </span><span class="pun">,</span><span class="pln"> children_data</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="nwkl">forward函数接收一系列的树节点对象作为输入，然后，<strong>递归神经网络</strong>将这些树节点作为子节点，并计算它们的父节点。最后，将计算的父节点保存在self.root变量中。</p><p data-anchor-id="dvsw">上面用到的concatenate函数，是将各个子节点中的数据拼接成一个长向量，其代码如下：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="wthk" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> concatenate</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> tree_nodes</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L2"><code class="language-python"><span class="str">        将各个树节点中的数据拼接成一个长向量</span></code></li><li class="L3"><code class="language-python"><span class="str">        '''</span></code></li><li class="L4"><code class="language-python"><span class="pln">        concat </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros</span><span class="pun">((</span><span class="lit">0</span><span class="pun">,</span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L5"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> node </span><span class="kwd">in</span><span class="pln"> tree_nodes</span><span class="pun">:</span></code></li><li class="L6"><code class="language-python"><span class="pln">            concat </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">concatenate</span><span class="pun">((</span><span class="pln">concat</span><span class="pun">,</span><span class="pln"> node</span><span class="pun">.</span><span class="pln">data</span><span class="pun">))</span></code></li><li class="L7"><code class="language-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> concat</span></code></li></ol></pre><p data-anchor-id="vioz">下面是反向传播算法BPTS的实现：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="fnql" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> backward</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> parent_delta</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L2"><code class="language-python"><span class="str">        BPTS反向传播算法</span></code></li><li class="L3"><code class="language-python"><span class="str">        '''</span></code></li><li class="L4"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">calc_delta</span><span class="pun">(</span><span class="pln">parent_delta</span><span class="pun">,</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">root</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">W_grad</span><span class="pun">,</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">b_grad </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">calc_gradient</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">root</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"></code></li><li class="L7"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> calc_delta</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> parent_delta</span><span class="pun">,</span><span class="pln"> parent</span><span class="pun">):</span></code></li><li class="L8"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L9"><code class="language-python"><span class="str">        计算每个节点的delta</span></code></li><li class="L0"><code class="language-python"><span class="str">        '''</span></code></li><li class="L1"><code class="language-python"><span class="pln">        parent</span><span class="pun">.</span><span class="pln">delta </span><span class="pun">=</span><span class="pln"> parent_delta</span></code></li><li class="L2"><code class="language-python"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">children</span><span class="pun">:</span></code></li><li class="L3"><code class="language-python"><span class="pln">            </span><span class="com"># 根据式2计算每个子节点的delta</span></code></li><li class="L4"><code class="language-python"><span class="pln">            children_delta </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">dot</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">W</span><span class="pun">.</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> parent_delta</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L5"><code class="language-python"><span class="pln">                self</span><span class="pun">.</span><span class="pln">activator</span><span class="pun">.</span><span class="pln">backward</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">children_data</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">            </span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">            </span><span class="com"># slices = [(子节点编号，子节点delta起始位置，子节点delta结束位置)]</span></code></li><li class="L8"><code class="language-python"><span class="pln">            slices </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> </span></code></li><li class="L9"><code class="language-python"><span class="pln">                        </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">node_width</span><span class="pun">)</span></code></li><li class="L0"><code class="language-python"><span class="pln">                        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">child_count</span><span class="pun">)]</span></code></li><li class="L1"><code class="language-python"><span class="pln">            </span><span class="com"># 针对每个子节点，递归调用calc_delta函数</span></code></li><li class="L2"><code class="language-python"><span class="pln">            </span><span class="kwd">for</span><span class="pln"> s </span><span class="kwd">in</span><span class="pln"> slices</span><span class="pun">:</span></code></li><li class="L3"><code class="language-python"><span class="pln">                self</span><span class="pun">.</span><span class="pln">calc_delta</span><span class="pun">(</span><span class="pln">children_delta</span><span class="pun">[</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]:</span><span class="pln">s</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]],</span><span class="pln"> </span></code></li><li class="L4"><code class="language-python"><span class="pln">                                parent</span><span class="pun">.</span><span class="pln">children</span><span class="pun">[</span><span class="pln">s</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]])</span></code></li><li class="L5"><code class="language-python"></code></li><li class="L6"><code class="language-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> calc_gradient</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> parent</span><span class="pun">):</span></code></li><li class="L7"><code class="language-python"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L8"><code class="language-python"><span class="str">        计算每个节点权重的梯度，并将它们求和，得到最终的梯度</span></code></li><li class="L9"><code class="language-python"><span class="str">        '''</span></code></li><li class="L0"><code class="language-python"><span class="pln">        W_grad </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros</span><span class="pun">((</span><span class="pln">self</span><span class="pun">.</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> </span></code></li><li class="L1"><code class="language-python"><span class="pln">                            self</span><span class="pun">.</span><span class="pln">node_width </span><span class="pun">*</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">child_count</span><span class="pun">))</span></code></li><li class="L2"><code class="language-python"><span class="pln">        b_grad </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros</span><span class="pun">((</span><span class="pln">self</span><span class="pun">.</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L3"><code class="language-python"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">children</span><span class="pun">:</span></code></li><li class="L4"><code class="language-python"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> W_grad</span><span class="pun">,</span><span class="pln"> b_grad</span></code></li><li class="L5"><code class="language-python"><span class="pln">        parent</span><span class="pun">.</span><span class="pln">W_grad </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">dot</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">delta</span><span class="pun">,</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">children_data</span><span class="pun">.</span><span class="pln">T</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">        parent</span><span class="pun">.</span><span class="pln">b_grad </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">delta</span></code></li><li class="L7"><code class="language-python"><span class="pln">        W_grad </span><span class="pun">+=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">W_grad</span></code></li><li class="L8"><code class="language-python"><span class="pln">        b_grad </span><span class="pun">+=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">b_grad</span></code></li><li class="L9"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> child </span><span class="kwd">in</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">children</span><span class="pun">:</span></code></li><li class="L0"><code class="language-python"><span class="pln">            W</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">calc_gradient</span><span class="pun">(</span><span class="pln">child</span><span class="pun">)</span></code></li><li class="L1"><code class="language-python"><span class="pln">            W_grad </span><span class="pun">+=</span><span class="pln"> W</span></code></li><li class="L2"><code class="language-python"><span class="pln">            b_grad </span><span class="pun">+=</span><span class="pln"> b</span></code></li><li class="L3"><code class="language-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> W_grad</span><span class="pun">,</span><span class="pln"> b_grad</span></code></li></ol></pre><p data-anchor-id="vjcb">在上述算法中，calc_delta函数和calc_gradient函数分别计算各个节点的误差项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-94-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -737.2000693679926 451.5 767.4001387359851" style="width: 1.089ex; height: 1.815ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B4"></use></g></svg></span><script type="math/tex" id="MathJax-Element-94">\delta</script>以及最终的梯度。它们都采用递归算法，先序遍历整个树，并逐一完成每个节点的计算。</p><p data-anchor-id="i3jr">下面是梯度下降算法的实现（没有weight decay），这个非常简单：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="602n" style=""><ol class="linenums"><li class="L0"><code class="language-pyhton"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span></code></li><li class="L1"><code class="language-pyhton"><span class="pln">        </span><span class="str">'''</span></code></li><li class="L2"><code class="language-pyhton"><span class="str">        使用SGD算法更新权重</span></code></li><li class="L3"><code class="language-pyhton"><span class="str">        '''</span></code></li><li class="L4"><code class="language-pyhton"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">W </span><span class="pun">-=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">learning_rate </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">W_grad</span></code></li><li class="L5"><code class="language-pyhton"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">b </span><span class="pun">-=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">learning_rate </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">b_grad</span></code></li></ol></pre><p data-anchor-id="icf0">以上就是<strong>递归神经网络</strong>的实现，总共100行左右，和上一篇文章的LSTM相比简单多了。</p><p data-anchor-id="ltz5">最后，我们用梯度检查来验证程序的正确性：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ygor" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">def</span><span class="pln"> gradient_check</span><span class="pun">():</span></code></li><li class="L1"><code class="language-python"><span class="pln">    </span><span class="str">'''</span></code></li><li class="L2"><code class="language-python"><span class="str">    梯度检查</span></code></li><li class="L3"><code class="language-python"><span class="str">    '''</span></code></li><li class="L4"><code class="language-python"><span class="pln">    </span><span class="com"># 设计一个误差函数，取所有节点输出项之和</span></code></li><li class="L5"><code class="language-python"><span class="pln">    error_function </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> o</span><span class="pun">:</span><span class="pln"> o</span><span class="pun">.</span><span class="pln">sum</span><span class="pun">()</span></code></li><li class="L6"><code class="language-python"></code></li><li class="L7"><code class="language-python"><span class="pln">    rnn </span><span class="pun">=</span><span class="pln"> </span><span class="typ">RecursiveLayer</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IdentityActivator</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">1e-3</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"></code></li><li class="L9"><code class="language-python"><span class="pln">    </span><span class="com"># 计算forward值</span></code></li><li class="L0"><code class="language-python"><span class="pln">    x</span><span class="pun">,</span><span class="pln"> d </span><span class="pun">=</span><span class="pln"> data_set</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">    rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></code></li><li class="L2"><code class="language-python"><span class="pln">    rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="pln">    </span><span class="com"># 求取sensitivity map</span></code></li><li class="L5"><code class="language-python"><span class="pln">    sensitivity_array </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">((</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">node_width</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span></code></li><li class="L6"><code class="language-python"><span class="pln">                                dtype</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">float64</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">    </span><span class="com"># 计算梯度</span></code></li><li class="L8"><code class="language-python"><span class="pln">    rnn</span><span class="pun">.</span><span class="pln">backward</span><span class="pun">(</span><span class="pln">sensitivity_array</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"></code></li><li class="L0"><code class="language-python"><span class="pln">    </span><span class="com"># 检查梯度</span></code></li><li class="L1"><code class="language-python"><span class="pln">    epsilon </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10e-4</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">W</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]):</span></code></li><li class="L3"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">W</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]):</span></code></li><li class="L4"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">W</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> epsilon</span></code></li><li class="L5"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">reset_state</span><span class="pun">()</span></code></li><li class="L6"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></code></li><li class="L7"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span></code></li><li class="L8"><code class="language-python"><span class="pln">            err1 </span><span class="pun">=</span><span class="pln"> error_function</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">root</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">W</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">epsilon</span></code></li><li class="L0"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">reset_state</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></code></li><li class="L2"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span></code></li><li class="L3"><code class="language-python"><span class="pln">            err2 </span><span class="pun">=</span><span class="pln"> error_function</span><span class="pun">(</span><span class="pln">rnn</span><span class="pun">.</span><span class="pln">root</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span></code></li><li class="L4"><code class="language-python"><span class="pln">            expect_grad </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">err1 </span><span class="pun">-</span><span class="pln"> err2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> epsilon</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">            rnn</span><span class="pun">.</span><span class="pln">W</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> epsilon</span></code></li><li class="L6"><code class="language-python"><span class="pln">            </span><span class="kwd">print</span><span class="pln"> </span><span class="str">'weights(%d,%d): expected - actural %.4e - %.4e'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L7"><code class="language-python"><span class="pln">                i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> expect_grad</span><span class="pun">,</span><span class="pln"> rnn</span><span class="pun">.</span><span class="pln">W_grad</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">])</span></code></li><li class="L8"><code class="language-python"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> rnn</span></code></li></ol></pre><p data-anchor-id="8u6t">下面是梯度检查的结果，完全正确，OH YEAH！</p><p data-anchor-id="d0nc"><img src="http://upload-images.jianshu.io/upload_images/2256672-bea78770357e735a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><div class="md-section-divider"></div><h2 data-anchor-id="r14b" id="递归神经网络的应用">递归神经网络的应用</h2><div class="md-section-divider"></div><h3 data-anchor-id="n550" id="自然语言和自然场景解析">自然语言和自然场景解析</h3><p data-anchor-id="2i8a">在自然语言处理任务中，如果我们能够实现一个解析器，将自然语言解析为语法树，那么毫无疑问，这将大大提升我们对自然语言的处理能力。解析器如下所示：</p><p data-anchor-id="mlrz"><img src="http://upload-images.jianshu.io/upload_images/2256672-6b7f075645c12c92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="ut9m">可以看出，<strong>递归神经网络</strong>能够完成句子的语法分析，并产生一个语法解析树。</p><p data-anchor-id="sdcu">除了自然语言之外，自然场景也具有<strong>可组合</strong>的性质。因此，我们可以用类似的模型完成自然场景的解析，如下图所示：</p><p data-anchor-id="f86o"><img src="http://upload-images.jianshu.io/upload_images/2256672-7ed5b7d06a8cc583.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title=""></p><p data-anchor-id="6az1">两种不同的场景，可以用相同的<strong>递归神经网络</strong>模型来实现。我们以第一个场景，自然语言解析为例。</p><p data-anchor-id="00l2">我们希望将一句话逐字输入到神经网络中，然后，神经网络返回一个解析好的树。为了做到这一点，我们需要给神经网络再加上一层，负责打分。分数越高，说明两个子节点结合更加紧密，分数越低，说明两个子节点结合更松散。如下图所示：</p><p data-anchor-id="l80o"><img src="http://upload-images.jianshu.io/upload_images/2256672-2f0393edbc04c30e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="" title=""></p><p data-anchor-id="vhe4">一旦这个打分函数训练好了（也就是矩阵U的各项值变为合适的值），我们就可以利用贪心算法来实现句子的解析。第一步，我们先将词按照顺序两两输入神经网络，得到第一组打分：</p><p data-anchor-id="2nyr"><img src="http://upload-images.jianshu.io/upload_images/2256672-be0eb2d1a3527bc6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="" title=""></p><p data-anchor-id="dbzb">我们发现，现在分数最高的是第一组，The cat，说明它们的结合是最紧密的。这样，我们可以先将它们组合为一个节点。然后，再次两两计算相邻子节点的打分：</p><p data-anchor-id="mh1j"><img src="http://upload-images.jianshu.io/upload_images/2256672-bb8f87bc4f56f5ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="" title=""></p><p data-anchor-id="bog5">现在，分数最高的是最后一组，the mat。于是，我们将它们组合为一个节点，再两两计算相邻节点的打分：</p><p data-anchor-id="499a"><img src="http://upload-images.jianshu.io/upload_images/2256672-9c3332923237d11c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="" title=""></p><p data-anchor-id="yhne">这时，我们发现最高的分数是on the mat，把它们组合为一个节点，继续两两计算相邻节点的打分......最终，我们就能够得到整个解析树：</p><p data-anchor-id="c0k6"><img src="http://upload-images.jianshu.io/upload_images/2256672-14f0140e4eafa5ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/480" alt="" title=""></p><p data-anchor-id="vfla">现在，我们困惑这样牛逼的打分函数score是怎样训练出来的呢？我们需要定义一个目标函数。这里，我们使用Max-Margin目标函数。它的定义如下：</p><div class="md-section-divider"></div><p data-anchor-id="n8gb"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-95-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -970.2000693679926 24254.077881632693 2183.656109255718" style="width: 56.371ex; height: 5.081ex; vertical-align: -2.903ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4A"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="633" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B8" x="1023" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1492" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="2159" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="3216" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="4094" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78" x="4624" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="5196" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="5586" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="6086" y="0"></use><g transform="translate(6531,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="848" y="-1536"></use></g><g transform="translate(8142,0)"><g transform="translate(286,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="878" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78" x="1408" y="0"></use></g><g transform="translate(0,-710)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="497" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-41" x="1165" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1915" y="0"></use><g transform="translate(1629,0)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3221" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="10696" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="11085" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="11555" y="0"></use><g transform="translate(11944,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="12861" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="13306" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="13804" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="14416" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394" x="15416" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="16250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="16639" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="17137" y="0"></use><g transform="translate(17582,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="18417" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="18806" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="19418" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="20419" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="20888" y="0"></use><g transform="translate(21278,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="22195" y="0"></use><g transform="translate(22640,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="23475" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="23864" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-95">
J(\theta)=max(0, \sum_i\underset{y\in A(x_i)}{max}(s(x_i,y)+\Delta(y,y_i))-s(x_i,y_i))
</script></p><p data-anchor-id="j6fp">在上式中，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -462.20006936799257 916.8053928999522 639.8854201102238" style="width: 2.177ex; height: 1.452ex; vertical-align: -0.484ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-96">x_i</script>、<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 834.8053928999522 688.4001387359851" style="width: 1.935ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-97">y_i</script>分别表示第i个训练样本的输入和标签，注意这里的标签<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 834.8053928999522 688.4001387359851" style="width: 1.935ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-98">y_i</script>是一棵解析树。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-99-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3445.2774524665706 1040.4001387359851" style="width: 7.984ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="469" y="0"></use><g transform="translate(859,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1775" y="0"></use><g transform="translate(2220,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3055" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-99">s(x_i,y_i)</script>就是打分函数s对第i个训练样本的打分。因为训练样本的标签肯定是正确的，我们希望s对它的打分越高越好，也就是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-100-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3445.2774524665706 1040.4001387359851" style="width: 7.984ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="469" y="0"></use><g transform="translate(859,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1775" y="0"></use><g transform="translate(2220,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3055" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-100">s(x_i,y_i)</script>越大越好。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-101-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 2555.9069439838668 1040.4001387359851" style="width: 5.927ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-41"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="750" y="0"></use><g transform="translate(1140,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2166" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-101">A(x_1)</script>是所有可能的解析树的集合，而<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-102-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3107.9720595666186 1040.4001387359851" style="width: 7.258ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="469" y="0"></use><g transform="translate(859,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1775" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="2220" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2718" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-102">s(x_i,y)</script>则是对某个可能的解析树<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-103-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 497.5 688.4001387359851" style="width: 1.21ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use></g></svg></span><script type="math/tex" id="MathJax-Element-103">y</script>的打分。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-104-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3389.9720595666186 1040.4001387359851" style="width: 7.863ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="833" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1223" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1720" y="0"></use><g transform="translate(2165,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3000" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-104">\Delta(y,y_i)</script>是对错误的惩罚。也就是说，如果某个解析树<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-105-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 497.5 688.4001387359851" style="width: 1.21ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use></g></svg></span><script type="math/tex" id="MathJax-Element-105">y</script>和标签<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-106-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 834.8053928999522 688.4001387359851" style="width: 1.935ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-106">y_i</script>是一样的，那么<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-107-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3389.9720595666186 1040.4001387359851" style="width: 7.863ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="833" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1223" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1720" y="0"></use><g transform="translate(2165,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3000" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-107">\Delta(y,y_i)</script>为0，如果网络的输出错的越离谱，那么惩罚项<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 3389.9720595666186 1040.4001387359851" style="width: 7.863ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="833" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1223" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1720" y="0"></use><g transform="translate(2165,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3000" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-108">\Delta(y,y_i)</script>的值就越高。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 10480.388563577682 1040.4001387359851" style="width: 24.315ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="878" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78" x="1408" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1980" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="2370" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2839" y="0"></use><g transform="translate(3229,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="809" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4145" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="4590" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="5088" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="5700" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394" x="6700" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="7534" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="7923" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="8421" y="0"></use><g transform="translate(8866,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="9701" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="10090" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-109">max(s(x_i,y)+\Delta(y,y_i))</script>表示所有树里面最高得分。在这里，惩罚项相当于Margin，也就是我们虽然希望打分函数s对正确的树打分比对错误的树打分高，但也不要高过Margin的值。我们优化<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-110-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -725.2000693679926 469.5 755.4001387359851" style="width: 1.089ex; height: 1.815ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B8"></use></g></svg></span><script type="math/tex" id="MathJax-Element-110">\theta</script>，使目标函数取最小值，即：</p><div class="md-section-divider"></div><p data-anchor-id="akic"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-111-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 6971.555555555556 1769.0617008467398" style="width: 16.21ex; height: 4.113ex; vertical-align: -2.419ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B8"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="747" y="0"></use><g transform="translate(1803,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-72" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-67" x="981" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D" x="1461" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="2340" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="2685" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B8" x="2088" y="-1234"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4A" x="5089" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="5723" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-3B8" x="6112" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6582" y="0"></use></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">
\theta=\underset{\theta}{argmin}J(\theta)
</script></p><p data-anchor-id="7ljf">下面是惩罚函数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-112-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -736.2000693679926 833.5 756.4001387359851" style="width: 1.935ex; height: 1.815ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394"></use></g></svg></span><script type="math/tex" id="MathJax-Element-112">\Delta</script>的定义：</p><div class="md-section-divider"></div><p data-anchor-id="7ptq"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-113-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -970.2000693679926 16449.272254573065 2415.5871334849053" style="width: 38.226ex; height: 5.565ex; vertical-align: -3.387ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-394"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="833" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1223" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1720" y="0"></use><g transform="translate(2165,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3000" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="3667" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="4724" y="0"></use><g transform="translate(5412,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211" x="464" y="0"></use><g transform="translate(0,-1149)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="523" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4E" x="1191" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2079" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="2469" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2966" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-31" x="7951" y="0"></use><g transform="translate(8527,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7B"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="970" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62" x="1542" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-54" x="1972" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-72" x="2676" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="3128" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="3594" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="4061" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64" x="4450" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="4974" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2209" x="5641" y="0"></use><g transform="translate(6586,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7D" x="7421" y="0"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">
\Delta(y,y_i)=k\sum_{d\in N(y)}\mathbf{1}{\{subTree(d)\notin y_i\}}
</script></p><p data-anchor-id="2hr6">上式中，N(y)是树y节点的集合；subTree(d)是以d为节点的子树。上式的含义是，如果以d为节点的子树没有出现在标签<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-114-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 834.8053928999522 688.4001387359851" style="width: 1.935ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-114">y_i</script>中，那么函数值+1。最终，惩罚函数的值，是树y中没有出现在树<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-115-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -463.20006936799257 834.8053928999522 688.4001387359851" style="width: 1.935ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-115">y_i</script>中的子树的个数，再乘上一个系数k。其实也就是关于两棵树差异的一个度量。</p><p data-anchor-id="jffb"><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-116-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -770.2000693679926 2763.666666666667 1040.4001387359851" style="width: 6.411ex; height: 2.419ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="469" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78" x="859" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1431" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1876" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2374" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-116">s(x,y)</script>是对一个样本最终的打分，它是对树y每个节点打分的总和。</p><div class="md-section-divider"></div><p data-anchor-id="umwx"><span class="MathJax_Preview"></span><div class="MathJax_SVG_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-117-Frame" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -970.2000693679926 8857.68002723094 2415.5871334849053" style="width: 20.565ex; height: 5.565ex; vertical-align: -3.387ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="469" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-78" x="859" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1431" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="1876" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2374" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="3041" y="0"></use><g transform="translate(4097,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ2-2211" x="1077" y="0"></use><g transform="translate(0,-1149)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="600" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="1268" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6F" x="1868" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64" x="2354" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="2877" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="3343" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="3813" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="4203" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="4700" y="0"></use></g></g><g transform="translate(7863,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="663" y="-213"></use></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-117">
s(x,y)=\sum_{n\in nodes(y)}s_n
</script></p><p data-anchor-id="iy3j">具体细节，读者可以查阅『参考资料3』的论文。</p><div class="md-section-divider"></div><h2 data-anchor-id="rmn3" id="小结">小结</h2><p data-anchor-id="9uda">我们在系列文章中已经介绍的<strong>全连接神经网络</strong>、<strong>卷积神经网络</strong>、<strong>循环神经网络</strong>和<strong>递归神经网络</strong>，在训练时都使用了<strong>监督学习(Supervised Learning)</strong>作为训练方法。在<strong>监督学习</strong>中，每个训练样本既包括输入特征<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.20006936799257 607.5 484.40013873598514" style="width: 1.452ex; height: 1.089ex; vertical-align: -0.121ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-78"></use></g></svg></span><script type="math/tex" id="MathJax-Element-118">\mathbf{x}</script>，也包括标记<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-119-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.20006936799257 607.5 684.4001387359851" style="width: 1.452ex; height: 1.573ex; vertical-align: -0.605ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-79"></use></g></svg></span><script type="math/tex" id="MathJax-Element-119">\mathbf{y}</script>，即样本<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-120-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.1292620390899 7205.096948555041 1183.3293314070825" style="width: 16.694ex; height: 2.782ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-64"></use><g transform="translate(524,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="734" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1697" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7B" x="2753" y="0"></use><g transform="translate(3254,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-78"></use><g transform="translate(607,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4756" y="0"></use><g transform="translate(5201,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-79"></use><g transform="translate(607,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7D" x="6704" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-120">d^{(i)}=\{\mathbf{x}^{(i)},\mathbf{y}^{(i)}\}</script>。然而，很多情况下，我们无法获得形如<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-121-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -913.1292620390899 4451.449817555213 1183.3293314070825" style="width: 10.282ex; height: 2.782ex; vertical-align: -0.726ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7B"></use><g transform="translate(500,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-78"></use><g transform="translate(607,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="2003" y="0"></use><g transform="translate(2448,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAINB-79"></use><g transform="translate(607,362)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="734" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-7D" x="3950" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-121">\{\mathbf{x}^{(i)},\mathbf{y}^{(i)}\}</script>的样本，这时，我们就不能采用<strong>监督学习</strong>的方法。在接下来的几篇文章中，我们重点介绍另外一种学习方法：<strong>增强学习(Reinforcement Learning)</strong>。在了解<strong>增强学习</strong>的主要算法之后，我们还将介绍著名的围棋软件<strong>AlphaGo</strong>，它是一个把<strong>监督学习</strong>和<strong>增强学习</strong>进行完美结合的案例。</p><p data-anchor-id="t3kc"><img src="http://upload-images.jianshu.io/upload_images/2256672-9f3e58723eee0af3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="" title=""></p><div class="md-section-divider"></div><h2 data-anchor-id="me0p" id="参考资料">参考资料</h2><ol data-anchor-id="jlls">
<li><a href="http://cs224d.stanford.edu/" target="_blank">CS224d: Deep Learning for Natural Language Processing</a></li>
<li><a href="https://pdfs.semanticscholar.org/794e/6ed81d21f1bf32a0fd3be05c44c1fa362688.pdf" target="_blank">Learning Task-Dependent Distributed Representations by Back Propagation Through Structure</a></li>
<li><a href="http://ai.stanford.edu/~ang/papers/icml11-ParsingWithRecursiveNeuralNetworks.pdf" target="_blank">Parsing Natural Scenes and Natural Language with Recursive Neural Networks</a></li>
</ol></div>
    <div class="remark-icons">
    </div>
</div>

<!--in page preview buttons. -->
<div class="in-page-preview-buttons in-page-preview-buttons-full-reader">
    <ul>
        <li class="in-page-button dropdown" id="preview-toc-button" title="内容目录 Ctrl+Alt+O">
            <span class="dropdown-toggle icon-list" data-toggle="dropdown"></span>
            <div id="toc-list" class="dropdown-menu theme pull-right"> <!-- Add theme means this element will be changed when apply theme color. -->
                <h3>内容目录</h3>
                <hr>
                <div class="table-of-contents"></div>
            </div>
        </li>
    </ul>
</div>

<div id="reader-full-toolbar" class="reader-full-toolbar-shown" style="padding-top: 0;">
    <ul id="reader-full-toolbar-home" class="preview-button-row">
        <li class="preview-button-full-reader" id="preview-editor-button" title="撰写文本 Ctrl+Alt+M">
            <span class="icon-pencil"></span>
        </li>
    </ul>
    <ul id="preview-button-row" class="preview-button-row">
        <li class="preview-button-full-reader dropdown" id="preview-list-button" title="文本列表 Ctrl+Alt+F">
            <span class="dropdown-toggle icon-reorder" data-toggle="dropdown"></span>
            <ul id="file-list" class="dropdown-menu theme-black pull-right" role="menu">
                    <li>
                    <ul class="tag-list">
                        <li class="tag-item item" tag-name="机器学习">
                            <span class="pull-left"><i class="icon-tag"></i><span class="tag-name">机器学习</span></span>
                            <span class="tag-count pull-right">7</span>
                            <div class="clearfix"></div>
                        </li>
                            
    <li class="file-item item" file-created-date="2017-02-27T16:59:57.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/626300" title="【已发布】 2017-08-29T15:41:15.000000Z">
        <i class="icon-share-sign"></i>
        <span id="626300" class="whiter-on-black">零基础入门深度学习(7) - 递归神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2017-01-08T15:28:36.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/581764" title="【已发布】 2017-08-28T11:55:38.000000Z">
        <i class="icon-share-sign"></i>
        <span id="581764">零基础入门深度学习(6) - 长短时记忆网络(LSTM)</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-11-05T11:16:51.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/541458" title="【已发布】 2017-08-28T11:54:33.000000Z">
        <i class="icon-share-sign"></i>
        <span id="541458">零基础入门深度学习(5) - 循环神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-10-09T12:30:46.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/485480" title="【已发布】 2017-08-28T11:53:32.000000Z">
        <i class="icon-share-sign"></i>
        <span id="485480">零基础入门深度学习(4) - 卷积神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-08-24T13:39:25.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/476663" title="【已发布】 2017-10-17T14:25:55.000000Z">
        <i class="icon-share-sign"></i>
        <span id="476663">零基础入门深度学习(3) - 神经网络和反向传播算法</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-07-25T17:44:30.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/448086" title="【已发布】 2017-08-28T11:40:02.000000Z">
        <i class="icon-share-sign"></i>
        <span id="448086">零基础入门深度学习(2) - 线性单元和梯度下降</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-07-12T03:10:42.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/433855" title="【已发布】 2017-08-28T11:35:23.000000Z">
        <i class="icon-share-sign"></i>
        <span id="433855">零基础入门深度学习(1) - 感知器</span>
        </a>
    </li>

                    </ul>
                    </li>
                    <li>
                    <ul class="tag-list">
                        <li class="tag-item item" tag-name="深度学习入门">
                            <span class="pull-left"><i class="icon-tag"></i><span class="tag-name">深度学习入门</span></span>
                            <span class="tag-count pull-right">7</span>
                            <div class="clearfix"></div>
                        </li>
                            
    <li class="file-item item" file-created-date="2017-02-27T16:59:57.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/626300" title="【已发布】 2017-08-29T15:41:15.000000Z">
        <i class="icon-share-sign"></i>
        <span id="626300" class="whiter-on-black">零基础入门深度学习(7) - 递归神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2017-01-08T15:28:36.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/581764" title="【已发布】 2017-08-28T11:55:38.000000Z">
        <i class="icon-share-sign"></i>
        <span id="581764">零基础入门深度学习(6) - 长短时记忆网络(LSTM)</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-11-05T11:16:51.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/541458" title="【已发布】 2017-08-28T11:54:33.000000Z">
        <i class="icon-share-sign"></i>
        <span id="541458">零基础入门深度学习(5) - 循环神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-10-09T12:30:46.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/485480" title="【已发布】 2017-08-28T11:53:32.000000Z">
        <i class="icon-share-sign"></i>
        <span id="485480">零基础入门深度学习(4) - 卷积神经网络</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-08-24T13:39:25.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/476663" title="【已发布】 2017-10-17T14:25:55.000000Z">
        <i class="icon-share-sign"></i>
        <span id="476663">零基础入门深度学习(3) - 神经网络和反向传播算法</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-07-25T17:44:30.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/448086" title="【已发布】 2017-08-28T11:40:02.000000Z">
        <i class="icon-share-sign"></i>
        <span id="448086">零基础入门深度学习(2) - 线性单元和梯度下降</span>
        </a>
    </li>

                            
    <li class="file-item item" file-created-date="2016-07-12T03:10:42.000000Z">
        <a tabindex="-1" href="https://zybuluo.com/hanbingtao/note/433855" title="【已发布】 2017-08-28T11:35:23.000000Z">
        <i class="icon-share-sign"></i>
        <span id="433855">零基础入门深度学习(1) - 感知器</span>
        </a>
    </li>

                    </ul>
                    </li>
            </ul>
            <ul id="file-list-topbar" class="dropdown-menu theme-black pull-right" role="menu">
                <li id="search-file-bar">
                    <i class="icon-search icon-large"></i>
                    <input type="text" id="search-file-textbox" placeholder="搜索 hanbingtao 的文稿标题， * 显示全部">
                    <i class="icon-level-down icon-rotate-90 icon-large"></i>
                </li>
                <li id="tag-file-bar">
                    以下【标签】将用于标记这篇文稿：
                </li>
            </ul>
        </li>
        <li class="preview-button-full-reader" id="preview-theme-button" title="主题切换 Ctrl+Alt+Y">
            <span class="icon-adjust"></span>
        </li>
        <li class="preview-button-full-reader" id="preview-fullscreen-button" title="全屏模式 F11">
            <span class="icon-fullscreen"></span>
        </li>
        <li class="preview-button-full-reader wmd-spacer"></li>
        <li class="preview-button-full-reader dropdown" id="preview-about-button" title="关于本站">
            <span class="dropdown-toggle icon-info-sign" data-toggle="dropdown" data-hover="dropdown" data-delay="100" data-close-others="true"></span>
            <ul id="about-menu" class="dropdown-menu theme-black pull-right" role="menu">
                <li title="下载全平台客户端"><a tabindex="-1" href="https://www.zybuluo.com/cmd" target="_blank"><i class="icon-laptop"></i>下载客户端</a></li>
                <li title="@ghosert"><a tabindex="-1" href="http://www.weibo.com/ghosert" target="_blank"><i class="icon-weibo"></i>关注开发者</a></li>
                <li title=""><a tabindex="-1" href="https://github.com/ghosert/cmd-editor/issues" target="_blank"><i class="icon-github-alt"></i>报告问题，建议</a></li>
                <li title="support@zybuluo.com"><a tabindex="-1" href="mailto:support@zybuluo.com" target="_blank"><i class="icon-envelope"></i>联系我们</a></li>
            </ul>
        </li>
    </ul>
</div>
<ul id="reader-full-toolbar-tail" class="reader-full-toolbar-tail-shown">
    <li class="preview-button-full-reader" id="preview-hidden-button" title="隐藏工具栏 Ctrl+Alt+I">
        <span class="icon-chevron-sign-right"></span>
    </li>
</ul>






<!-- side remark, hidden when loading. -->
<div class="remark-list side-remark-hidden">
    <div class="remark-items">
    </div>
    <div class="leave-remark unselectable"><span class='icon-plus-sign-alt'></span><span>添加新批注</span></div>
    <div class="new-remark">
        <!-- clone the template $('.new-remark-reply').html() to here.-->
        <div class="remark-notice">在作者公开此批注前，只有你和作者可见。</div>
    </div>
</div>

<!-- template for new remark/reply -->
<div class="new-remark-reply side-remark-hidden">
    <div class="remark-head"><a><img src="https://zybuluo.com/static/img/default-head.jpg"></a></div>
    <div class="remark-author unselectable"></div>
    <div class="remark-editor" contentEditable="true" spellcheck="false"></div>
    <!-- this will be filled up by js.
    <div class="inline-error">402/400</div> for new remark
    <div class="inline-error">202/200</div> for new reply
    -->
    <div class="remark-footer unselectable">
        <button class="remark-save btn-link">保存</button>
        <button class="remark-cancel btn-link">取消</button>
    </div>
</div>

<!-- template for .remark-item/.remark-reply -->
<div class="remark-item-reply side-remark-hidden">
    <div class="remark-head"><a><img src="https://zybuluo.com/static/img/default-head.jpg"></a></div>
    <div class="remark-author unselectable"></div>
    <div class="remark-delete-link unselectable"><span class="icon-remove"></span></div> <!--This is mainly for deleting remark-reply, shown when author/remark hovering on remark-reply.-->
    <div class="remark-editor" contentEditable="true" spellcheck="false"></div>
    <!-- this will be filled up by js.
    <div class="inline-error">402/400</div> for new remark
    <div class="inline-error">202/200</div> for new reply
    -->
    <div class="remark-footer unselectable">
        <button class="remark-edit btn-link">修改</button>
        <button class="remark-save btn-link">保存</button>
        <button class="remark-cancel btn-link">取消</button>
        <button class="remark-delete btn-link">删除</button>
    </div>
</div>

<!-- template for remark-item-->
<div class="remark-item side-remark-hidden" data-rand-id="" data-version-id="">
    <div class="remark-published-link unselectable"><span class="icon-link icon-rotate-90"></span></div>
    <ul class="remark-options theme unselectable">
        <li class="remark-private"><span class="icon-eye-close"></span><span>私有</span></li>
        <li class="remark-public"><span class="icon-group"></span><span>公开</span></li>
        <li class="remark-delete"><span class="icon-remove"></span><span>删除</span></li>
    </ul>

    <!-- clone the template $('.remark-item-reply').html() to here.-->

    <button class="remark-reply-view-more btn-link">查看更早的 5 条回复</button>
    <div class="remark-replies">
        <!--
        <div class="remark-reply">
            clone the template $('.remark-item-reply').html() to here.
        </div>
        -->
    </div>

    <div class="leave-reply unselectable"><span>回复批注</span></div>
    <div class="new-reply">
        <!-- clone the template $('.new-remark-reply').html() to here.-->
    </div>
</div>

<!-- jiawzhang NOTICE: .remark-icons will be put to mdeditor.mako and user_note.mako, where next to .wmd-preview -->
<!-- <div class="remark-icons"></div> -->

<!-- template for remark-icon -->
<div class="remark-icon unselectable side-remark-hidden remark-icon-empty" style="display: none;">
    <span class="icon-stack">
        <i class="glyph-comment"></i>
        <span class="remark-count"></span>
    </span>
</div>


<!-- canvas, hidden always, this is used to convert svg to canvas and then convert canvas to png. -->
<canvas id="svg-canvas-image" class="editor-reader-hidden-always"></canvas>

<!-- This is the image panel to hold enlarged image/svg. -->
<div id="large-image-panel">
    <img id="large-image"/>
</div>


    


    <!-- Hidden Popup Modal -->
    <div id="notification-popup-window" class="modal hide fade theme" tabindex="-1" role="dialog" aria-labelledby="notification-title" aria-hidden="true">
        <div class="modal-header theme">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="notification-title">通知</h3>
        </div>
        <div class="modal-body theme">
            <p></p>
        </div>
        <div class="modal-footer theme">
            <button id="notification-cancel" class="btn" data-dismiss="modal" aria-hidden="true">取消</button>
            <button id="notification-confirm" class="btn btn-primary">确认</button>
        </div>
    </div>

    <!-- zybuluo's foot -->

    <script src="https://zybuluo.com/static/assets/288313bb.base.lib.min.js"></script>

    <script>
        Namespace('com.zybuluo.base');
        com.zybuluo.base.initData = {
            globalPromptUrl: "https://zybuluo.com/global/prompt",
        };
    </script>

    
    <!--mathjax-->
    <!--blacker: 1 below means font weight.-->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]], processEscapes: true }, TeX: { equationNumbers: { autoNumber: "AMS" } }, messageStyle: "none", SVG: { blacker: 1 }});
    </script>
    <script src="https://zybuluo.com/static/editor/libs/mathJax.js"></script>
    <!--mathjax source code is here: https://github.com/mathjax/MathJax.-->
    <script src="https://zybuluo.com/static/MathJax/MathJax.js?config=TeX-AMS-MML_SVG"></script>

    <script>
        Namespace('com.zybuluo.mdeditor.layout');
        com.zybuluo.mdeditor.layout.initData = {
            // '' means not logged in, otherwise the logged in username, for mdeditor.mako, this value will be reset in render.js otherwise, for user_note.mako, it's rendered by server side.
            loggedInUsername: '',
            isPageOwner: 'False' === 'True' ? true : false,
            loginComeFromUrl: 'https://zybuluo.com/login?return_to=https%3A%2F%2Fzybuluo.com%2Fhanbingtao%2Fnote%2F626300',
            noteRemarksUrl: "https://zybuluo.com/note/626300/remarks", 
            newNoteRemarkUrl: "https://zybuluo.com/note/626300/remark/new", 
            updateNoteRemarkUrl: "https://zybuluo.com/note/626300/remark/update", 
            deleteNoteRemarkUrl: "https://zybuluo.com/note/626300/remark/delete", 
            publishNoteRemarkUrl: "https://zybuluo.com/note/626300/remark/publish", 
            newNoteRemarkReplyUrl: "https://zybuluo.com/note/626300/remark_reply/new", 
            updateNoteRemarkReplyUrl: "https://zybuluo.com/note/626300/remark_reply/update", 
            deleteNoteRemarkReplyUrl: "https://zybuluo.com/note/626300/remark_reply/delete", 
        };

        // BEGIN: pace.js configuration
        window.paceOptions = {
            // disable others, enable for ajax call only,
            ajax: true,
            document: false,
            elements: false,
            eventLag: false,
        };
        // jiawzhang NOTICE: to make sure pace.js is working for any ajax call especially the jquery ajax, add 'Pace.restart()' into jquery ajax call like '$.post'
        // Originally, pace 0.5.6 doesn't support jquery ajax, see details in: https://github.com/HubSpot/pace/issues/29
        // END: pace.js configuration

    </script>

    <script src="https://zybuluo.com/static/assets/mdeditor/7a70106e.layout.lib.min.js"></script>

    <script src="https://zybuluo.com/static/assets/mdeditor/dc648f35.layout.min.js"></script>



    

    <!-- https://zybuluo.com/static/assets/mdeditor/user_note.lib.min.js -->
    <!-- -->

    <script>
        Namespace('com.zybuluo.mdeditor.user_note');
        com.zybuluo.mdeditor.user_note.initData = {
            isLoggedIn: 'False',
            mdeditorUrl: "https://zybuluo.com/mdeditor",
            passwordPassed: 'True' === 'True' ? true : false,
        };
    </script>

    <script src="https://zybuluo.com/static/assets/mdeditor/6cd3112e.user_note.min.js"></script>



</body>
</html>
    
